/**** 废弃文件*/
if (typeof Mobi == "undefined") {
    Mobi = {}
}
Mobi.isTopWindow = function(){
	if(window===window.top){
		return true;
	}
	return false;
}
Mobi.getPreviewWindow = function() {
    var b = JRF.top.document.getElementById("mobiReviewPageFrame");
    var a = !b ? window: b.contentWindow;
    return a
};
Mobi.getPreviewDocument = function() {
    var a = Mobi.getPreviewWindow().document;
    return a
};
Mobi.getPreviewObject = function(a) {
    if (!a) {
        return
    }
    return Mobi.getPreviewDocument().getElementById(a)
};
Mobi.getPreviewObjectClass = function(a) {
    if (!a) {
        return
    }
    return Mobi.getPreviewDocument().getElementsByClassName(a)
};
Mobi.getJQMobi = function() {
    var b = Mobi.getPreviewWindow(),
    a = b.jm;
    return a
};
Mobi.getModuleWindow = function() {
    var a = JRF.top.document.getElementById("mobiModuleFrame");
    var b = !a ? window: a.contentWindow;
    return b
};
Mobi.getModuleObject = function(a) {
    if (!a) {
        return
    }
    return Mobi.getModuleWindow().document.getElementById(a)
};
Mobi.getTemplateWindow = function() {
    var a = JRF.top.document.getElementById("mobiTemplateFrame");
    var b = !a ? window: a.contentWindow;
    return b
};
Mobi.getTemplateObject = function(a) {
    if (!a) {
        return
    }
    return Mobi.getTemplateWindow().document.getElementById(a)
};
Mobi.getTemplateDocument = function() {
    var a = Mobi.getTemplateWindow().document;
    return a
};
Mobi.getStyleWindow = function() {
    var a = JRF.top.document.getElementById("mobiStyleFrame");
    var b = !a ? window: a.contentWindow;
    return b
};
Mobi.getStyleDocument = function() {
    var a = Mobi.getStyleWindow().document;
    return a
};
Mobi.getBannerWindow = function() {
    var b = JRF.top.document.getElementById("mobiBannerFrame");
    var a = !b ? window: b.contentWindow;
    return a
};
Mobi.getBannerObject = function(a) {
    if (!a) {
        return
    }
    return Mobi.getBannerWindow().document.getElementById(a)
};
Mobi.getSettingWindow = function() {
    var b = JRF.top.document.getElementById("mobiSettingFrame");
    var a = !b ? window: b.contentWindow;
    return a
};
Mobi.getServiceWindow = function() {
    var a = JRF.top.document.getElementById("mobiServiceFrame");
    var b = !a ? window: a.contentWindow;
    return b
};
Mobi.getSettingObject = function(a) {
    if (!a) {
        return
    }
    return Mobi.getSettingWindow().document.getElementById(a)
};
Mobi.getColumnWindow = function() {
    var a = JRF.top.document.getElementById("mobiColumnFrame");
    var b = !a ? window: a.contentWindow;
    return b
};
Mobi.getColumnObject = function(a) {
    if (!a) {
        return
    }
    return Mobi.getColumnWindow().document.getElementById(a)
};
Mobi.getWxSettingWindow = function() {
    var a = JRF.top.document.getElementById("wxSettingFrame");
    var b = !a ? window: a.contentWindow;
    return b
};
Mobi.getWxSettingObject = function(a) {
    if (!a) {
        return
    }
    return Mobi.getWxSettingWindow().document.getElementById(a)
};
Mobi.designInitStyleTabs = function() {
    JRF.top.$("ul.tabs").tabs("div.panes > div")
};
Mobi.switchMobiWXPanel = function(d) {
    var f = JRF.top.$("#saveButton");
    var a = JRF.top.$("#cancelButton");
    var e = JRF.top.$("#viewButton");
    var b = JRF.top.$("#mobiReview");
    var c = JRF.top.$("#ing");
    if (d) {
        f.css("display", "block");
        a.css("display", "block");
        e.css("display", "block");
        b.show()
    } else {
        f.css("display", "none");
        a.css("display", "none");
        e.css("display", "none");
        b.hide()
    }
    c.remove()
};
Mobi.mobiStyleTabClick = function(a) {
    var a = JRF.top.$("#tabs a").index(JRF.top.$("#mobiStyleTab"));
    Mobi.cutMobiTab("rightIframePanels", "choicePanel", a);
    Mobi.stylePanesShow(true);
    JRF.top.$("#mobiStyleTab").addClass("current");
    var c = JRF.top.$("#mobiStyleFrame"),
    b = JRF.top.$("#mobiStyle");
    if (!c.attr("src") || c.attr("src").indexOf("javascript") != -1) {
        c.attr("src", "mobiStyle.jsp?ram=" + Math.random())
    }
    b.show();
    JRF.top._mobiTabInit.initParent = 0;
    Mobi.logDog(200006, 0);
    return c
};
Mobi.mobiModuleTabClick = function() {
    var a = JRF.top.$("#mobiModuleFrame"),
    b = JRF.top.$("#mobiModule");
    if (!a.attr("src") || a.attr("src").indexOf("javascript") != -1) {
        a.attr("src", "mobiModule.jsp?ram=" + Math.random())
    }
    Mobi.switchMobiWXPanel(true);
    Mobi.logDog(200006, 1);
    return a
};
Mobi.mobiServiceTabClick = function(b) {
    var b = JRF.top.$("#tabs a").index(JRF.top.$("#mobiServiceTab"));
    Mobi.cutMobiTab("rightIframePanels", "choicePanel", b);
    Mobi.stylePanesShow(true);
    JRF.top.$("#mobiServiceTab").addClass("current");
    var a = JRF.top.$("#mobiServiceFrame"),
    c = JRF.top.$("#mobiService");
    if (!a.attr("src") || a.attr("src").indexOf("javascript") != -1) {
        a.attr("src", "mobiService.jsp?ram=" + Math.random())
    }
    JRF.top._mobiTabInit.initParent = 5;
    Mobi.logDog(200006, 5);
    return a
};
Mobi.mobiColumnTabClick = function(b) {
    var b = JRF.top.$("#tabs a").index(JRF.top.$("#mobiColumnTab"));
    Mobi.cutMobiTab("rightIframePanels", "choicePanel", b);
    Mobi.stylePanesShow(true);
    JRF.top.$("#mobiColumnTab").addClass("current");
    var a = JRF.top.$("#mobiColumnFrame"),
    c = JRF.top.$("#mobiColumn");
    if (!a.attr("src") || a.attr("src").indexOf("javascript") != -1) {
        a.attr("src", "mobiColumn.jsp?ram=" + Math.random())
    }
    c.show();
    JRF.top._mobiTabInit.initParent = 2;
    Mobi.logDog(200006, 2);
    return a
};
Mobi.cutMobiTab = function(a, e, c) {
    var d = $("#" + a),
    b = $("#" + a + " >." + e);
    b.removeClass("activeTab");
    $(b[c]).addClass("activeTab");
    $.cookie("_mobiTabInit", JSON.stringify(JRF.top._mobiTabInit))
};
Mobi.mobileSiteTab = function(a) {
    if ($("#topSetButtonMobi").hasClass("topSetCurrent")) {
        return
    }
    $("#topBarArea .topSetButton").removeClass("topSetCurrent");
    $("#topSetButtonMobi").addClass("topSetCurrent");
    $("#topBarArea .topSetBottom").removeClass("topSetCurrentWX").addClass("topSetCurrentMobi");
    Mobi.mobiModuleTabClick();
    Mobi.cutMobiTab("mobiStyleDesignPanel", "choicePanel", 0);
    Mobi.logDog(200025, 0)
};
Mobi.mobiSettingTabClick = function(c) {
    var a = JRF.top.$("#tabs a").index(JRF.top.$("#mobiSettingTab"));
    Mobi.cutMobiTab("rightIframePanels", "choicePanel", a);
    Mobi.stylePanesShow(true);
    JRF.top.$("#mobiSettingTab").addClass("current");
    var d = JRF.top.$("#mobiSettingFrame"),
    b = JRF.top.$("#mobiSetting");
    if (!d.attr("src") || d.attr("src").indexOf("javascript") != -1) {
        d.attr("src", "mobiSetting.jsp?ram=" + Math.random());
        d.load(function() {
            if (c == "advance") {
                Mobi.initTab({
                    initParent: 3,
                    initChild: 3
                })
            }
        })
    } else {
        if (c == "base") {
            Mobi.initTab({
                initParent: 3,
                initChild: 0
            })
        } else {
            if (c == "advance") {
                Mobi.initTab({
                    initParent: 3,
                    initChild: 3
                })
            }
        }
    }
    b.show();
    JRF.top._mobiTabInit.initParent = 3;
    Mobi.logDog(200006, 3);
    return d
};
Mobi.wxPlatformTabClick = function(d, c) {
    var e = {};
    e.fun = function() {
        Mobi.styleRecover()
    };
    if (Mobi.checkSaveBar(e, true)) {
        return false
    }
    if ($("#topSetButtonWX").hasClass("topSetCurrent")) {
        return
    }
    $("#topBarArea .topSetButton").removeClass("topSetCurrent");
    $("#topSetButtonWX").addClass("topSetCurrent");
    $("#topBarArea .topSetBottom").addClass("topSetCurrentWX").removeClass("topSetCurrentMobi");
    Mobi.cutMobiTab("mobiStyleDesignPanel", "choicePanel", 1);
    JRF.top.$("#wxSettingTab").addClass("current");
    var b = JRF.top.$("#wxSettingFrame"),
    a = JRF.top.$("#wxSetting");
    Mobi.switchMobiWXPanel(false);
    if (!b.attr("src") || b.attr("src").indexOf("javascript") != -1) {
        b.attr("src", "wxPlatform.jsp?ram=" + Math.random())
    }
    a.show();
    Mobi.initFrameClick(b, c);
    Mobi.logDog(200006, 4);
    Mobi.logDog(200025, 1);
    return b
};
Mobi.initTab = function(b, d, a) {
    if (!b) {
        if ($.cookie("_mobiTabInit") && $.cookie("_mobiTabInit") !== "undefined" && $.cookie("_mobiTabInit") !== "null") {
            b = $.parseJSON($.cookie("_mobiTabInit"))
        } else {
            b = JRF.top._mobiTabInit
        }
    }
    var c;
    Mobi.mobileSiteTab();
    if (b.initParent === 2) {
        c = Mobi.mobiColumnTabClick()
    } else {
        if (b.initParent === 3) {
            c = Mobi.mobiSettingTabClick()
        } else {
            if (b.initParent === 4) {
                c = Mobi.wxPlatformTabClick()
            } else {
                if (b.initParent === 5) {
                    c = Mobi.mobiServiceTabClick()
                } else {
                    if (b.initParent === 6 && d) {
                        c = Mobi.mobiModuleTabClick()
                    } else {
                        c = Mobi.mobiStyleTabClick()
                    }
                }
            }
        }
    }
    if (!d) {
        JRF.top._mobiTabInit = b
    }
    Mobi.initFrameClick(c, b)
};
Mobi.initFrameClick = function(c, a) {
	function b(f) {
        var e = c[0].contentDocument.querySelector(".mobiLeftSidebar"),
        d = e ? e.querySelectorAll(".mobiTemColumn") : null;
        if (d) {
            if (f) {
                a.initChild = e.querySelector(".mobiTabCurrent") ? parseInt($(e.querySelector(".mobiTabCurrent")).attr("_pos")) : 0
            }
            if (d[a.initChild]) {
                d[a.initChild].click()
            } else {
                a.initChild = 0;
                d[a.initChild].click()
            }
        }
    };
	if(!JRF.isNull(c[0])){
		if (c[0].contentDocument && c[0].contentDocument.body.innerHTML == "") {
	        c[0].onload = function() {
	            b();
	        }
	    } else {
	        b();
	    }
	    
	}
};
Mobi.mobiTabsStyle = function() {
    JRF.top.$("#tabs a").removeClass("current")
};
Mobi.stylePanesShow = function(a) {
    if (a) {
        JRF.top.$("#panes > .mobiModuleFrame").hide();
        JRF.top.$("#tabs a").removeClass("current")
    }
    JRF.top.$("#tabs > li").hover(function() {
        var b = $(this).find("a").hasClass("current");
        if (!b) {
            $(this).addClass("tabHover").siblings().removeClass("tabHover")
        }
    },
    function() {
        var b = $(this).find("a").hasClass("current");
        if (!b) {
            $(this).removeClass("tabHover")
        }
    });
    JRF.top.$("#tabs > li").bind("click",
    function() {
        $(this).removeClass("tabHover")
    })
};
Mobi.styleLoading = function(a, c) {
    if (!a || !c) {
        return
    }
    var b = $('<div class="forWaiting ajaxLoading2" style="position:absolute;background-color:#fff;width:100%;height:400px;top:0px;left:0;"></div>');
    b.appendTo("#" + a);
    $("#" + c).load(function() {
        $(".forWaiting").remove()
    })
};
Mobi.closeStyleDesign = function() {
    if (JRF.top._changeStyleNum == 0) {
        return
    }
    JRF.top.location.reload(true);
    Mobi.logDog(200025, 18)
};
/** 加载当前模块*/
Mobi.loadCurrentModule = function(d, h) {
    if (d != top.window._colId) {
        return
    }
    var a = top.document.getElementById("mobiModuleFrame"),
    b = Mobi.getModuleWindow(),
    c = Mobi.getModuleObject("mobiChoiceModulePanel"),
    g = function(k, j) {
        JRF.top._columnModuleHiddenListChanged++;
        JRF.top._columnModuleHiddenList.push(parseInt(k));
        var i = Mobi.getPreviewDocument().getElementById("module" + k);
        if (i) {
            $(i).fadeOut(600);
            setTimeout(function() {
                $(Mobi.getPreviewObject("module" + k)).appendTo($(Mobi.getPreviewObject("hiddenModuleForms")));
                Mobi.getPreviewWindow().Mobi.displayAddModule();
                Mobi.AllShowTopForBottom();
            },
            600)
        }
        Mobi.styleChanged()
    },
    f = function(m, l) {
        $(l).parent().fadeOut(500);
        var k = Mobi.getPreviewDocument().getElementById("module" + m);
        if (k) {
            $(k).fadeOut(600);
            setTimeout(function() {
                $(Mobi.getPreviewObject("module" + m)).appendTo($(Mobi.getPreviewObject("hiddenModuleForms")));
                Mobi.getPreviewWindow().Mobi.displayAddModule()
            },
            600)
        }
        for (var j = JRF.top._columnModuleHiddenList.length - 1; j >= 0; j--) {
            if (JRF.top._columnModuleHiddenList[j] === parseInt(m)) {
                JRF.top._columnModuleHiddenList.splice(j, 1)
            }
        }
        if (JRF.top._delModuleList.indexOf(parseInt(m)) == -1) {
            JRF.top._delModuleList.push(parseInt(m))
        }
        JRF.top._columnModuleHiddenListChanged++;
        Mobi.styleChanged()
    },
    e = $('<div class="iframeLoading iframeLoadingBackground"></div>');
	if (!$(a).attr("src") || $(a).attr("src").indexOf("javascript") != -1) {
		return
	}
    e.appendTo($(c));
    $.ajax({
        type: "get",
        url: "/manage/ajax/col_h.jsp?cmd=getColModule&_colId=" + d + "&extId=" + JRF.top._extId + "&v=" + Math.random() * 1000,
        error: function() {
            JRF.ing("加载失敗", true);
            return
        },
        success: function(y) {
            y = $.parseJSON(y);
            if (y.success && y.allModuleListInfo) {
                var v = [],
                o = y.allModuleListInfo,
                l = Mobi.getModuleObject("mobiModulesCurrent"),
                t = y.moduleList,
                s;
                b.$(l).html("");
                var w = Mobi.getPreviewObject("navbarList");
                $(w.querySelectorAll("a")).bind("click",function() {return false});
                s = Mobi.getModuleWindow().modules();
                for (var r in o) {
                    var k = o[r].id,
                    m = true,
                    p = o[r].type == 1 ? "delButton": "",
                    j;
                    $(s).each(function(z, A) {
                    	//if (A.styleId == o[r].style && o[r].type == 1) {
                    	if (A.styleId == o[r].style) {
                            j = A.styleClass;
                            return false
                        } else {
                            j = "system"
                        	}
                    	});
                    for (var n in t) {
                        if (k == t[n].id) {
                            m = false;
                            continue
                        }
                    }
                    if (j == "cubeNavigation") {
                        o[r].name = "魔方导航"
                    }
                    var moduleIcon = o[r].moduleIcon;
                    var num = o[r].num;
                    var i = (j === "system") ? "disabledButton": "checkButton";
                    var div_prop = (j==="system")?"sys=true":"";
                    var x = new Array();
                	x.push('<div '+div_prop+' id="nowModuleItem'+k+'" num="'+num+'" class="addNewModule'+k+' addNewModule addNewModule_'+j+'">');
                	x.push('	<div id="nowModuleDel'+k+'" class="delButton '+p+'" title="删除模块，保存后生效"></div>');
                	x.push('	<div id="leftIcon'+k+'" class="leftIcon" >');
                		/*** 图标移出
                	if(num>JRF.top.siteVersionWeight){
                		x.push('	<p style="background: url('+ moduleIcon +') no-repeat;" class="module_icon right_b"></p>');
                		}
                		*/
                	x.push('		<div id="nowModuleCheck' + k + '" class="' + i + '" ' + (m ? "": 'style="display: block;"') + '></div>');
                	x.push('	</div>');
                	x.push('	<div id="rightIcon' + k + '" class="rightIcon" title="' + JRF.encodeHtml(o[r].name) + '">'+JRF.encodeHtml(o[r].name)+'</div>');
                	x.push('</div>');
                   
                    b.$(l).append(x.join(""));
                }
                b.$("#mobiModulesCurrent").on("click", ".delButton",
                function(z) {
                    var A = $(this).attr("id");
                    A = A.substr(12, A.length);
                    if ($("#nowModuleItem" + A).hasClass("addNewModule_cubeNavigation")) {
                        Mobi.removeDefaultCubeList(A, JRF.top._other)
                    }
                    f(A, this);
                    JRF.top._delButtonChanged++;
                    return false
                });
                b.$("#mobiModulesCurrent .addNewModule").hover(function(z) {
                    var A = this.id.replace("nowModuleItem", "");
                    b.$("#nowModuleItem" + A + " .delButton").css("display", "block")
                },
                function() {
                    var z = this.id.replace("nowModuleItem", "");
                    b.$("#nowModuleItem" + z + " .delButton").css("display", "none")
                });
                b.$("#mobiModulesCurrent").on("click", ".addNewModule",
                function(z) {
                    u(this)
                });
                function u(z) {
                    var A = parseInt($(z).attr("id").replace(/\D/g, ""));
                    if ($(z).attr("sys") || $(z).attr("current")) {
                        return
                    }
                    $(z).attr("current", true);
                    if ($(z).find(".checkButton").is(":hidden")) {
                        $(z).find(".checkButton").show();
                        Mobi.getPreviewWindow().Mobi.addModule(A, d)
                    } else {
                        $(z).find(".checkButton").hide();
                        g(A, z);
                    }
                    setTimeout(function() {
                        $(z).removeAttr("current")
                    },
                    600);
                    return false
                }
                $.each(JRF.top._hideNowModuleCheckList,
                function(A, z) {
                    $(Mobi.getModuleObject(z)).css("display", "none")
                });
                $.each(JRF.top._addNowModuleCheckList,
                function(A, z) {
                    $(Mobi.getModuleObject(z)).css("display", "block")
                });
                $(w.querySelectorAll("a")).unbind("click");
                var q = function() {
                    JRF.top._mCustomScrollbar && JRF.top._mCustomScrollbar.mCustomScrollbar("destroy");
                    JRF.top._mCustomScrollbar = Mobi.getModuleWindow().$("#mobiChoiceModulePanel").mCustomScrollbar({
                        scrollInertia: 100,
                        theme: "dark-3",
                        scrollButtons: {
                            enable: true
                        },
                        advanced: {
                            updateOnContentResize: true
                        },
                        axis: "y"
                    });
                    setTimeout(function() {
                        if (Mobi.getModuleWindow().$("#mobiChoiceModulePanel .mCSB_scrollTools").css("display") === "none") {
                            Mobi.getModuleWindow().$("#mobiModulesCurrent").css("margin-left", "4px")
                        }
                    },
                    0)
                } ();
                e.remove()
            }
        }
    })
};
Mobi.addNewCurrentModuleIcon = function(f) {
    if (!f) {
        return
    }
    var e = Mobi.getModuleWindow().modules();
    var b;
    $(e).each(function(g, h) {
        if (h.styleId == f.style) {
            b = h.styleClass;
            return false
        }
    });
    var d = '<div id="nowModuleItem' + f.id + '" class="addNewModule' + f.id + " addNewModule addNewModule_" + b + '"><div id="nowModuleDel' + f.id + '" class="delButton" title="删除模块，保存后生效"></div><div id="leftIcon' + f.id + '" class="leftIcon"><div id="nowModuleCheck' + f.id + '" class="checkButton" style="display: block;"></div></div><div id="rightIcon' + f.id + '" class="rightIcon" title="' + JRF.encodeHtml(f.name) + '">' + JRF.encodeHtml(f.name) + "</div></div>",
    a = Mobi.getModuleWindow(),
    c = a.document.getElementById("mobiModulesCurrent");
    a.$(c).append(d)
};
Mobi.manageCreateSlideBar = function(e) {
    if (!e) {
        return
    }
    var g = e.baseClass,
    f = e.parentId,
    a = e.slideParentId,
    i = e.property,
    j = "",
    d = "";
    if (!f) {
        return
    }
    var c;
    for (var h in i) {
        if (parseInt(h) === 0) {
            c = i[h].id
        }
        if (i[h].id === "wxReplay") {
            d += '<div class="wxFunction">';
            d += '<div class="wxFunctionBox"><div class="wxFunctionImg"></div><div class="wxFunctionFont">功能</div></div>';
            d += '<div  class="' + g + '" _pos="' + h + '" id="' + i[h].id + '">' + i[h].text + "</div>"
        } else {
            if (i[h].id === "materialManage") {
                d += '</div><div class="wxLine"></div><div class="wxManage">';
                d += '<div class="wxManageBox"><div class="wxManageImg"></div><div class="wxManageFont">管理</div></div>';
                d += '<div  class="' + g + '" _pos="' + h + '" id="' + i[h].id + '">' + i[h].text + "</div>"
            } else {
                if (i[h].id === "wxSetting") {
                    if (i.length !== 1) {
                        d += '</div><div class="wxLine"></div><div class="wxPublicSetting">';
                        d += '<div class="wxPublicSettingBox"><div class="wxSettingImg"></div><div class="wxSettingFont">设置</div></div>';
                        d += '<div  class="' + g + '" _pos="' + h + '" id="' + i[h].id + '">' + i[h].text + "</div>";
                        d += "</div>"
                    } else {
                        d += '<div class="wxPublicSetting">';
                        d += '<div class="wxPublicSettingBox"><div class="wxSettingImg"></div><div class="wxSettingFont">设置</div></div>';
                        d += '<div  class="' + g + '" _pos="' + h + '" id="' + i[h].id + '">' + i[h].text + "</div>";
                        d += "</div>"
                    }
                } else {
                    d += '<div  class="' + g + '" _pos="' + h + '" id="' + i[h].id + '">' + i[h].text + "</div>"
                }
            }
        }
    }
    if (f === "wxSlide") {
        d += '<div class="slideBar"><div class="wxSlideBarTip transitionPanel" style="left: 130px;"></div></div>'
    } else {
        if (f !== "wxColumnSlider") {
            d += '<div class="slideBar"><div class="slideBarTip transitionPanel"></div></div>'
        }
    }
    $("#" + j + "Panel").show(100);
    a && Mobi.cutMobiTab(a, "choicePanel", 0);
    $("#" + f).append(d).click(function(l) {
        k(l)
    });
    c && b(document.getElementById(c));
    function k(p) {
        var s = $.browser.msie ? p.srcElement && p.srcElement.id: p.target && p.target.id,
        o = 0;
        if (s == "") {
            s = p.target.parentNode.id
        }
        for (var l in i) {
            if (s === i[l].id) {
                $(".mobiTemColumn").removeClass("mobiTabCurrent");
                var n = $("#" + s);
                if (!n.hasClass("mobiModColumn")) {
                    JRF.top._mobiTabInit.initChild = parseInt(n.attr("_pos"))
                }
                if (n.find(".mobiTabCurrent").size() !== 0) {
                    return
                }
                n.addClass("mobiTabCurrent");
                if (i[l].callback) {
                    new Function(i[l].callback)()
                }
                if (i[l].iframe) {
                    var r = i[l].iframe[0].iframeId,
                    q = i[l].iframe[0].iframeCallbackFun,
                    t = i[l].iframe[0].iframeUrl;
                    var m = document.getElementById(r).contentWindow;
                    if (!$("#" + r).attr("src")) {
                        $("#" + r).attr("src", t);
                        $("#" + r).load(function() {
                            if (q) {
                                m[q]()
                            }
                        })
                    } else {
                        if (q) {
                            m[q]()
                        }
                    }
                }
                a && Mobi.cutMobiTab(a, "choicePanel", o);
                b(p.target)
            }
            o++
        }
    }
    function b(m) {
        var l = m.offsetLeft;
        if ($("#" + f + " .wxSlideBarTip").length > 0) {
            l = l + $(m).outerWidth() / 2 - $("#" + f + " .wxSlideBarTip").width() / 2;
            $("#" + f + " .wxSlideBarTip").css("left", l + "px");
            $(m).addClass("mobiTabCurrent")
        } else {
            l = l + $(m).outerWidth() / 2 - $("#" + f + " .slideBarTip").width() / 2;
            $("#" + f + " .slideBarTip").css("left", l + "px");
            $(m).addClass("mobiTabCurrent")
        }
    }
};
Mobi.logout = function(a) {
    JRF.ing("正在退出系统...", false);
    $.ajax({
        type: "post",
        url: Mobi.getAjaxUrl("login_h.jsp?cmd=logout"),
        error: function() {
            JRF.ing("系统繁忙，请稍后重试。")
        },
        success: function(b) {
            JRF.successHandle(b, "", "系统繁忙，请稍后重试。", a, 1, 1)
        }
    })
};
Mobi.saveDesignToCheckUpRedirectUrl = function(a, c, b) {
    if (a != null) {
        if (a == "javascript:;") {
            JRF.top.location.reload()
        } else {
            a = (a[0] !== "/" && a.indexOf("/") === -1 ? "/" + a: a);
            $("#mobiReviewPageFrame").attr("src", a)
        }
        if (c != null) {
            if (b && Object.prototype.toString.call(b) === "[object Function]") {
                b(c)
            }
        }
    }
};
/** 手机模块拖拽功能保存*/
Mobi.saveStyle = function(o) {
    if (JRF.top._changeStyleNum == 0) {
        return
    }
    
    var d = "set";
    var c = new Array();
    c.push("cmd=" + d);
    c.push("&colId=" + top.window._colId);
    c.push("&extId=" + JRF.top._extId);
    if (JRF.top._templateChanged > 0) {
        c.push("&templateId=" + parseInt(JRF.top._templateFrameId))
    }
    if (JRF.top._bannerChanged > 0) {
        c.push("&banner=" + JRF.encodeUrl($.toJSON(JRF.top._bannerData)))
    }
    if (JRF.top._siteBannerChanged > 0) {
        c.push("&pageBanner=" + JRF.top._siteBanner)
    }
    if (JRF.top._mobileSiteChanged > 0) {
        c.push("&msiteOpen=" + JRF.top._mobileSite)
    }
    if (JRF.top._columnOrderChanged > 0) {
        c.push("&colOrder=" + JRF.encodeUrl($.toJSON(JRF.top._columnOrderData)))
    }
    if (JRF.top._imagePageChanged > 0) {
        c.push("&imgPage=" + JRF.encodeUrl($.toJSON(JRF.top._imagePageJson)))
    }
    if (JRF.top.backgroundImageChanged > 0) {
        c.push("&backgroundImg=" + JRF.encodeUrl($.toJSON(JRF.top.backgroundImageJson)))
    }
    if (typeof JRF.top._mobiPdIndependence != "undefined") {
        c.push("&mobiPdIndependence=" + JRF.top._mobiPdIndependence)
    }
    if (JRF.top._mobiLogoJsonChanged > 0) {
        if (JRF.top._mobiLogoJson.mobi_h) {
            if (JRF.top._mobiLogoJson.fileId == "") {
                Mobi.mobiSettingTabClick("base");
                JRF.ing("Logo没有上传图片，请上传图片！", false);
                return
            }
        }
        c.push("&logo=" + JRF.encodeUrl($.toJSON(JRF.top._mobiLogoJson)))
    }
    if (JRF.top._columnStyleJsonChanged > 0) {
        c.push("&columnStyle=" + JRF.encodeUrl($.toJSON(JRF.top._columnStyleJson)))
    }
    if (JRF.top._browserTitleChanged > 0) {
        c.push("&browserTitle=" + JRF.encodeUrl(JRF.top._browserTitle));
        Mobi.logDog(200020, 0)
    }
    if (JRF.top._mobiSiteTitleChanged > 0) {
        c.push("&title=" + JRF.encodeUrl($.toJSON(JRF.top._mobiSiteTitle)));
        Mobi.logDog(200020, 1)
    }
    if (JRF.top._onlineServiceChange > 0) {
        c.push("&onlineService=" + JRF.encodeUrl($.toJSON(JRF.top._onlineServiceJson)))
    }
    var l = Mobi.getJQMobi(),
    a = l("#webModuleContainer .form"),
    h = new Array();
    $.each(a,
    function(j, q) {
    	if(a[j].getAttribute("id")!= 'fullScreenDivCotainer'){
	        var p = parseInt(a[j].getAttribute("id").replace("module", ""));
	        h.push(p)
    	}
    });

    if (typeof JRF.top.moduleAttr != "undefined") {
        var n = [];
        $.each(JRF.top.moduleAttr,
        function(p, j) {
            var r = parseInt(p.replace("module", ""));
            if (r <= 0) {
                return true
            }
            if ($(Mobi.getPreviewObject("module" + r)).length == 0) {
                return true
            }
            var s = {};
            var q = false;
            var i = Mobi.getModuleAttr(r);
            if (i.pattern.changed) {
                s.pattern = $.toJSON(Mobi.getModuleAttrPatternStg(r));
                q = true
            }
            if (q) {
                s.id = r;
                n.push(s)
            }
        });
        if (n.length > 0) {
            c.push("&moduleStyleList=");
            c.push($.toJSON(n))
        }
    }
    for (var g = 0; g < JRF.top._columnModuleHiddenList.length; ++g) {
        for (var f = 0; f < h.length; f++) {
            if (JRF.top._columnModuleHiddenList[g] == h[f]) {
                JRF.top._columnModuleHiddenList.splice(g, 1);
                break
            }
        }
    }
    c.push("&moduleHidden=" + JRF.encodeUrl($.toJSON(JRF.top._columnModuleHiddenList)));
    if (JRF.top._siteKeyWordChange > 0) {
        c.push("&searchKeyword=" + JRF.encodeUrl(JRF.top._siteKeyWord));
        Mobi.logDog(200023, 0)
    }
    if (JRF.top._siteDescChange > 0) {
        c.push("&searchDesc=" + JRF.encodeUrl(JRF.top._siteDesc));
        Mobi.logDog(200023, 1)
    }
    if (JRF.top._showMemberChange > 0) {
        c.push("&showMember=" + JRF.encodeUrl(JRF.top._showMember))
    }
    if (JRF.top._mallChange > 0) {
        c.push("&mallOpen=" + JRF.encodeUrl(JRF.top._mobiMallOpen))
    }
    if (typeof JRF.top._mobiTitleFlg != "undefined") {
        c.push("&mobiTitle=" + JRF.encodeUrl(JRF.top._mobiTitleFlg.toString()))
    }
    if (typeof JRF.top._mobiFooterClose != "undefined") {
        c.push("&mobiFooter=" + JRF.encodeUrl(JRF.top._mobiFooterClose))
    }
    if (JRF.top._headerCodeChange > 0) {
        c.push("&headerCode=" + JRF.encodeUrl(JRF.top._headerCode))
    }
    if (JRF.top._otherChange > 0) {
        if (JRF.top._other.favIcon.showType == 1 && JRF.top._other.favIcon.id == "") {
            Mobi.mobiSettingTabClick("advance");
            JRF.ing("没有上传网站图标，请上传图片！", false);
            return
        }
        if (JRF.top._other.iosIcon.showType == 1 && JRF.top._other.iosIcon.id == "") {
            Mobi.mobiSettingTabClick("advance");
            JRF.ing("没有上传iPhone桌面图标，请上传图片！", false);
            return
        }
        c.push("&other=" + JRF.encodeUrl($.toJSON(JRF.top._other)))
    }
    if(JRF.top._otherChange > 0){
    	c.push("&")
    }
    var e = JRF.encodeUrl($.toJSON(h));
    c.push("&moduleList=" + e);
    c.push("&delModuleList=" + JRF.encodeUrl($.toJSON(JRF.top._delModuleList)));
    JRF.top._changeStyleNum = 0;
    $("#saveButton").attr("disabled", true).addClass("buttonDisabled");
    $.ajax({
        type: "post",
        url: Mobi.getAjaxUrl("mobi_h.jsp?v=" + Math.random() * 1000),
        data: c.join(""),
        error: function() {
            $("#saveButton").removeAttr("disabled").removeClass("buttonDisabled");
            JRF.ing("系统繁忙，请稍候重试");
            JRF.top._changeStyleNum++
        },
        success: function(i) {
            Mobi.logDog(200025, 17);
            var j = JRF.successHandle(i, "保存成功", "", "", 3, 1);
            if (j) {
                if (typeof o === "object") {
                    Mobi.closeStyleDesign();
                    if (typeof o.fun === "function") {
                        setTimeout(function() {
                            o.fun.apply(window, o.args)
                        },
                        10)
                    }
                } else {
                    JRF.top.location.reload();
                    JRF.ing("保存成功！", true)
                }
            } else {
                JRF.top._changeStyleNum++
            }
        }
    })
};
Mobi.getAjaxUrl = function(b) {
    var a = "";
    if (document.location.pathname.indexOf("/manage/") >= 0) {
        a = "../ajax/"
    } else {
        a = "ajax/"
    }
    return a + b
};
Mobi.removeCtrlStyleCss = function(c, b, j, h) {
    var a = $(Mobi.getPreviewObject(c));
    var g = new Array();
    if (a.length == 1) {
        var f = a.html();
        f = f.replace(/{\r\n/g, "{").replace(/\t/g, "").replace(/\r\n}/g, ";}");
        g = f.split("\n");
        a.remove()
    }
    var d = new RegExp("#" + b + " +" + j.replace(".", "\\.") + " *{ *" + h + "[^;]*;", "gi");
    if (b == "" || b == "undefined") {
        d = new RegExp(j.replace(".", "\\.") + " *{ *" + h + "[^;]*;", "gi")
    }
    for (var e = g.length - 1; e >= 0; --e) {
        var k = g[e];
        if (k.length == 0 || /^\s$/.test(k) || d.test(k)) {
            g.splice(e, 1)
        }
    }
    $(Mobi.getPreviewDocument().querySelector("head")).append('<style type="text/css" id="' + c + '">' + g.join("\n") + "</style>")
};
Mobi.removeCtrlStyleCssList = function(c, b, h) {
    var a = $(Mobi.getPreviewObject(c));
    var j = new Array();
    if (a.length == 1) {
        var g = a.html();
        g = g.replace(/{\r\n/g, "{").replace(/\t/g, "").replace(/\r\n}/g, ";}");
        j = g.split("\n");
        a.remove()
    }
    for (var f = j.length - 1; f >= 0; --f) {
        var m = j[f];
        for (var e = 0; e < h.length; ++e) {
            var l = h[e].cls;
            var k = h[e].key;
            var d = new RegExp("#" + b + " +" + l.replace(".", "\\.") + " *{ *" + k + "[^;]*;", "gi");
            if (b == "" || b == "undefined") {
                d = new RegExp(l.replace(".", "\\.") + " *{ *" + k + "[^;]*;", "gi")
            }
            if (m.length == 0 || /^\s$/.test(m) || d.test(m)) {
                j.splice(f, 1);
                break
            }
        }
    }
    $(Mobi.getPreviewDocument().querySelector("head")).append('<style type="text/css" id="' + c + '">' + j.join("\n") + "</style>")
};
Mobi.setCtrlStyleCss = function(c, b, k, j, h) {
    var a = $(Mobi.getPreviewObject(c));
    var g = new Array();
    if (a.length == 1) {
        var f = a.html();
        f = f.replace(/{\r\n/g, "{").replace(/\t/g, "").replace(/\r\n}/g, ";}");
        g = f.split("\n");
        a.remove()
    }
    var d = new RegExp("#" + b + " +" + k.replace(".", "\\.") + " *{ *" + j + "[^;]*;", "gi");
    if (b == "" || b == "undefined") {
        d = new RegExp(k.replace(".", "\\.") + " *{ *" + j + "[^;]*;", "gi")
    }
    for (var e = g.length - 1; e >= 0; --e) {
        var l = g[e];
        if (l.length == 0 || /^\s$/.test(l) || d.test(l)) {
            g.splice(e, 1)
        }
    }
    if (b == "" || b == "undefined") {
        g.push(k + "{" + j + ":" + h + ";}")
    } else {
        g.push("#" + b + " " + k + "{" + j + ":" + h + ";}")
    }
    $(Mobi.getPreviewDocument().querySelector("head")).append('<style type="text/css" id="' + c + '">' + g.join("\n") + "</style>")
};
Mobi.setCtrlStyleCssList = function(c, b, h, o) {
    var a = $(Mobi.getPreviewObject(c));
    var j = new Array();
    if (a.length == 1) {
        var g = a.html();
        g = g.replace(/{\r\n/g, "{").replace(/\t/g, "").replace(/\r\n}/g, ";}");
        j = g.split("\n");
        a.remove()
    }
    for (var f = j.length - 1; f >= 0; --f) {
        var m = j[f];
        for (var e = 0; e < h.length; ++e) {
            var l = h[e].cls;
            var k = h[e].key;
            var d = new RegExp("#" + b + " +" + l.replace(".", "\\.") + " *{ *" + k + "[^;]*;", "gi");
            if (b == "" || b == "undefined") {
                d = new RegExp(l.replace(".", "\\.") + " *{ *" + k + "[^;]*;", "gi")
            }
            if (m.length == 0 || /^\s$/.test(m) || d.test(m)) {
                j.splice(f, 1);
                break
            }
        }
    }
    for (var e = 0; e < h.length; ++e) {
        if (b == "" || b == "undefined") {
            j.push(h[e].cls + "{" + h[e].key + ":" + h[e].value + ";}")
        } else {
            j.push("#" + b + " " + h[e].cls + "{" + h[e].key + ":" + h[e].value + ";}")
        }
    }
    if (o && o.rev) {
        j.reverse()
    }
    $(Mobi.getPreviewDocument().querySelector("head")).append('<style type="text/css" id="' + c + '">' + j.join("\n") + "</style>")
};
Mobi.setNavStyleCss = function(c, a, b, d) {
    Mobi.setCtrlStyleCss("mobiStyleNav", "navbar_" + c, a, b, d)
};
Mobi.removeNavStyleCss = function(c, a, b) {
    Mobi.removeCtrlStyleCss("mobiStyleNav", "navbar_" + c, a, b)
};
Mobi.setNavStyleCssList = function(b, a) {
    Mobi.setCtrlStyleCssList("mobiStyleNav", "navbar_" + b, a)
};
Mobi.setModuleStyleCss = function(c, a, b, d) {
    Mobi.setCtrlStyleCss("mobiStyleModule", "module" + c, a, b, d)
};
Mobi.setModuleStyleCssList = function(b, a) {
    Mobi.setCtrlStyleCssList("mobiStyleModule", "module" + b, a)
};
Mobi.removeModuleStyleCss = function(c, a, b) {
    Mobi.removeCtrlStyleCss("mobiStyleModule", "module" + c, a, b)
};
Mobi.removeModuleStyleCssList = function(b, a) {
    Mobi.removeCtrlStyleCssList("mobiStyleModule", "module" + b, a)
};
Mobi.hideModuleBannerBg = function(a) {
    Mobi.setModuleStyleCssList(a, [{
        cls: ".formBannerTitle" + a,
        key: "background",
        value: "none"
    },
    {
        cls: ".formBannerTitle" + a + " .titleLeft" + a,
        key: "background",
        value: "none"
    },
    {
        cls: ".formBannerTitle" + a + " .titleCenter" + a,
        key: "background",
        value: "none"
    },
    {
        cls: ".formBannerTitle" + a + " .titleRight" + a,
        key: "background",
        value: "none"
    }])
};
Mobi.showModuleBannerBg = function(a) {
    Mobi.removeModuleStyleCssList(a, [{
        cls: ".formBannerTitle" + a,
        key: "background"
    },
    {
        cls: ".formBannerTitle" + a + " .titleLeft" + a,
        key: "background"
    },
    {
        cls: ".formBannerTitle" + a + " .titleCenter" + a,
        key: "background"
    },
    {
        cls: ".formBannerTitle" + a + " .titleRight" + a,
        key: "background"
    }])
};
Mobi.hideModuleContentBg = function(a) {
    Mobi.setModuleStyleCssList(a, [{
        cls: "",
        key: "background",
        value: "none"
    },
    {
        cls: ".formMiddle" + a,
        key: "background",
        value: "none"
    },
    {
        cls: ".g_background",
        key: "background",
        value: "none"
    },
    {
        cls: ".formMiddle" + a + " .formMiddleCenter" + a,
        key: "background",
        value: "none"
    },
    {
        cls: ".formMiddleContent" + a,
        key: "background",
        value: "none"
    }])
};
Mobi.showModuleContentBg = function(a) {
    Mobi.removeModuleStyleCssList(a, [{
        cls: "",
        key: "background"
    },
    {
        cls: ".formMiddle" + a,
        key: "background"
    },
    {
        cls: ".g_background",
        key: "background"
    },
    {
        cls: ".formMiddle" + a + " .formMiddleCenter" + a,
        key: "background"
    },
    {
        cls: ".formMiddleContent" + a,
        key: "background"
    }])
};
Mobi.refreshModuleHeight = function(b) {
    var a = $(Mobi.getPreviewObject("module" + b));
    if (a.attr("_autoHeight") == 0) {
        Mobi.setModuleHeight(b, a.height())
    }
};
Mobi.setModuleHeight = function(c, a) {
    var b = $(Mobi.getPreviewObject("module" + c));
    b.attr("_autoHeight", "0");
    Mobi.getPreviewWindow().Mobi.setModuleHeight2(c, a)
};
Mobi.autoModuleHeight = function(c) {
    var b = $(Mobi.getPreviewObject("module" + c));
    b.css("height", "auto");
    b.find(".formMiddle").first().css("height", "auto");
    var a = b.find(".formMiddleContent").first();
    a.css("height", "auto");
    a.css("overflow-y", "auto")
};
Mobi.fileUpload2 = function(f, d, g) {
    var e = {
        title: "选择图片",
        type: [],
        siteDomain: "",
        maxSize: 1,
        maxUploadList: 10,
        maxChoiceList: 10,
        imgMode: 0,
        imgMaxWidth: 2048,
        imgMaxHeight: 2048,
        netFileMode: false
    };
    if (d) {
        $.extend(e, d)
    }
    if (JRF.top._siteVer != "undefined" && JRF.top._siteVer == 10) {
        e.maxSize = 1
    }
    var c = e.title;
    // if (e.type.length > 0) {
    //     if (JRF.top._siteVer != "undefined" && JRF.top._siteVer == 10) {
    //         c += "<span style='font-weight:400;'> (只能添加" + e.type.join(",") + ", 大小不超过" + e.maxSize + "MB)</span>"
    //     } else {
    //         c += "<span style='font-weight:400;'> (只能添加" + e.type.join(",") + ", 大小不超过" + e.maxSize + "MB)</span>"
    //     }
    // } else {
    //     c += "<span style='font-weight:400;'> (上传大小不超过" + e.maxSize + "MB)</span>"
    // }
    var params = new Array();
    params.push("maxUploadList="+e.maxUploadList);
    params.push("&maxChoiceList="+e.maxChoiceList);
    params.push("&imgMode="+e.imgMode);
    params.push("&imgMaxWidth="+e.imgMaxWidth);
    params.push("&imgMaxHeight="+e.imgMaxHeight);
    params.push("&entry="+e.entry);
    params.push("&createScale="+e.createScale);
    var a = JRF.top._siteDomain + "/manage/fileUploadV.jsp?"+params.join("");
    if(e.entry == "QRCodeImgUpload"){
    	a = "fileUploadV.jsp?"+params.join("");
    }
    var b = {
        title: c,
        frameSrcUrl: a,
        width: 665,
        height: 490,
        saveBeforePopup: false,
        callArgs: "add",
        closeFunc: g
    };
    if (f) {
        $(f).unbind("click").bind("click",
        function() {
            JRF.popupWindow(b)
        })
    } else {
        JRF.popupWindow(b)
    }
};
Mobi.getModuleAttrPattern = function(b) {
    var a = Mobi.getModuleAttr(b);
    return a.pattern
};
Mobi.getModuleAttr = function(c) {
    var a = JRF.top.moduleAttr["module" + c],
    b = $(Mobi.getPreviewObject("module" + c));
    if (typeof a == "undefined") {
        JRF.top.moduleAttr["module" + c] = {};
        a = JRF.top.moduleAttr["module" + c]
    }
    if (typeof a.pattern == "undefined") {
        a.pattern = {}
    }
    if (typeof a.data == "undefined") {
        a.data = {}
    }
    var e = a.data;
    if (typeof e.changed == "undefined") {
        e.changed = false
    }
    var d = a.pattern;
    if (typeof d.changed == "undefined") {
        d.changed = false
    }
    if (typeof d.border == "undefined") {
        if (b.hasClass("formStyle31")) {
            d.border = {
                y: 1
            }
        } else {
            d.border = {
                y: 0
            }
        }
    }
    if (typeof d.bannerType == "undefined") {
        d.bannerType = 0
    }
    if (typeof d.bannerAutoHeight == "undefined") {
        d.bannerAutoHeight = true
    }
    if (typeof d.bannerText == "undefined") {
        d.bannerText = {
            y: 0
        }
    }
    if (typeof d.bannerMore == "undefined") {
        d.bannerMore = {
            y: 0
        }
    }
    if (typeof d.bannerBg == "undefined") {
        d.bannerBg = {
            y: 0
        }
    }
    if (typeof d.outside == "undefined") {
        d.outside = {
            y: 0
        }
    }
    if (typeof d.inner == "undefined") {
        d.inner = {
            y: 0
        }
    }
    if (typeof d.contentText == "undefined") {
        d.contentText = {
            y: 0
        }
    }
    if (typeof d.contentLink == "undefined") {
        d.contentLink = {
            y: 0
        }
    }
    if (typeof d.contentBg == "undefined") {
        if (b.hasClass("formStyle31")) {
            d.contentBg = {
                y: 1
            }
        } else {
            d.contentBg = {
                y: 0
            }
        }
    }
    if (typeof d.transparent == "undefined") {
        d.transparent = 100
    }
    return a
};
Mobi.getModuleAttrPatternStg = function(b) {
    var c = $(Mobi.getPreviewObject("module" + b));
    var h = {};
    var j = Mobi.getModuleAttrPattern(b);
    var m = 0;
    if (c.length > 0) {
        m = parseInt(c.height());
        if (c.attr("_autoHeight") == 0 && m > 0) {
            h.h = m
        }
    }
    var o = j.transparent;
    h.tran = parseInt(o);
    if (j.bannerType == 1) {
        h.e = 1
    }
    if (j.bannerAutoHeight == false) {
        h.bh = parseInt(c.find(".formBannerTitle")[0].clientHeight)
    }
    h.d = {};
    h.d.y = 0;
    var f = j.border;
    if (f.y == 1) {
        h.d.y = 1
    } else {
        if (f.y == 2) {
            h.d.y = 2;
            h.d.c = f.c;
            h.d.w = parseInt(f.w);
            h.d.s = parseInt(f.s)
        }
    }
    h.v = 0;
    var i = j.bannerText;
    if (i.y == 1) {
        h.bt = {};
        h.bt.y = 1
    } else {
        if (i.y == 2) {
            h.bt = {};
            h.bt.y = 2;
            h.bt.f = i.f;
            h.bt.s = parseInt(i.s);
            h.bt.w = parseInt(i.w);
            h.bt.c = i.c;
            h.bt.fct = parseInt(i.fct);
            h.bt.a = parseInt(i.a);
            if (i.py == 1) {
                h.bt.py = 1;
                h.bt.r = parseInt(i.r);
                h.bt.u = parseInt(i.u);
                h.bt.p = i.p
            }
        }
    }
    var d = j.bannerMore;
    if (d.y == 1) {
        h.bm = {};
        h.bm.y = 1;
        h.bm.f = d.f;
        h.bm.s = parseInt(d.s);
        h.bm.w = parseInt(d.w);
        h.bm.d = parseInt(d.d);
        h.bm.c = d.c;
        h.bm.fct = parseInt(d.fct);
        if (d.py == 1) {
            h.bm.py = 1;
            h.bm.r = parseInt(d.r);
            h.bm.u = parseInt(d.u)
        }
    }
    var e = j.bannerBg;
    h.bg = {};
    h.bg.y = 0;
    if (e.f) {
        h.bg.f = e.f
    }
    if (e.y == 1) {
        h.bg.y = 1
    } else {
        if (e.y == 2) {
            h.bg.y = 2;
            h.bg.c = e.c;
            h.bg.r = parseInt(e.r)
        }
    }
    var k = j.outside;
    if (k.y == 1) {
        h.o = {};
        h.o.y = 1;
        h.o.l = parseInt(k.l);
        h.o.r = parseInt(k.r);
        h.o.t = parseInt(k.t);
        h.o.b = parseInt(k.b)
    }
    var n = j.inner;
    if (n.y == 1) {
        h.i = {};
        h.i.y = 1;
        h.i.l = parseInt(n.l);
        h.i.r = parseInt(n.r);
        h.i.t = parseInt(n.t);
        h.i.b = parseInt(n.b)
    }
    var a = j.contentText;
    if (a.y == 1) {
        h.ct = {};
        h.ct.y = 1;
        h.ct.f = a.f;
        h.ct.c = a.c;
        h.ct.fct = parseInt(a.fct);
        h.ct.cs = parseInt(a.cs)
    }
    var l = j.contentLink;
    if (l.y == 1) {
        h.cl = {};
        h.cl.y = 1;
        h.cl.f = l.f;
        h.cl.d = parseInt(l.d);
        h.cl.c = l.c;
        h.cl.fct = parseInt(l.fct);
        h.cl.ls = parseInt(l.ls)
    }
    var g = j.contentBg;
    h.cb = {};
    h.cb.y = 0;
    if (g.f) {
        h.cb.f = g.f
    }
    if (g.y == 1) {
        h.cb.y = 1
    } else {
        if (g.y == 2) {
            h.cb.y = 2;
            h.cb.c = g.c;
            h.cb.r = parseInt(g.r)
        }
    }
    return h
};
Mobi.addNewModule = function(b, f, d, g, j) {
    var i = null;
    var a = null;
    var e = null;
    var c = null;
    var h = parent.preModulePosition;
    if (typeof j == "object" && j) {
        if (j.callback) {
            i = j.callback
        }
        if (j.allCheckList) {
            a = j.allCheckList
        }
        if (j.parentId) {
            e = j.parentId
        }
        if (j.colId) {
            c = j.colId
        }
    }
    if (typeof b == "undefined" || !b) {
        return
    }
    if (!h) {
        Mobi.getPreviewWindow().$("#webModuleContainer").prepend(f)
    } else {
        Mobi.getPreviewWindow().$("#webModuleContainer").children("div:not('#dragPlaceholder')").eq(h - 1).after(f);
        parent.preModulePosition = 0
    }
    Mobi.getPreviewWindow().Mobi.displayAddModule();
    Mobi.getPreviewWindow().Mobi.addNowModuleCheck(b);
    Mobi.AllShowTopForBottom();
    //Mobi.getPreviewWindow().location.hash = "";
    //Mobi.getPreviewWindow().location.hash = "#module" + b;
    if(!g || g != 'content'){
    	JRF.top._changeStyleNum++;
    	Mobi.styleChanged()
    }
};
Mobi.getCookieFlag = function(b) {
    if (b >= 32) {
    	$.alert("参数错误");
        return
    }
    var a = JRF.Cookie.get("_mobiFlag");
    if (a == null) {
        a = 0
    } else {
        a = parseInt(a)
    }
    return ((a & (1 << b)) != 0) ? true: false
};
Mobi.setCookieFlag = function(d, a) {
    if (d >= 32) {
    	$.alert("参数错误");
        return
    }
    var b = JRF.Cookie.get("_mobiFlag");
    if (b == null) {
        b = 0
    } else {
        b = parseInt(b)
    }
    if (a) {
        b |= (1 << d)
    } else {
        b &= ~ (1 << d)
    }
    var e = 30 * 12 * 5;
    var c = new Date();
    c.setTime(c.getTime() + e * 24 * 60 * 60 * 1000);
    JRF.Cookie.set("_mobiFlag", b, c)
};
Mobi.renderUEditor = function(b) {
    var a = {
        ueditorId: null,
        setPageChange: null,
        initContent: null,
        minFrameHeight: 0,
        jinrfRichTip: null,
        imageExtends: false,
        wordCount: false,
        maximumWords: 0,
        withPage: null,
        flash: null,
        fixUrl: false,
        customDomain: true,
        isPasteImage: true,
        setContentTxt: false,
        flashHidden: true,
        htmlChoiceImage: "Mobi.htmlChoiceImage(editor)",
        htmlChoiceMP4: Mobi.htmlChoiceMP4,
        toolbars: [["shrinkopenup", "removeformat", "|", "bold", "italic", "underline", "|", "fontfamily", "fontsize", "forecolor", "backcolor", "|", "insertorderedlist", "insertunorderedlist", "lineheight", "justifyright", "|", "link", "unlink", "phone", "insertimage", "insertmp4", "|", "pasteplain", "|", "swfuploadWord", "|", "source", "||", , "selectall", "undo", "redo", "|", "strikethrough", "superscript", "subscript", "horizontal", "zhspace", "|", "indent", "rowspacingtop", "rowspacingbottom", "|", "|", "fullscreen"]],
        fontfamily: null,
        isMobi: true,
        mobiEditor: true,
        openJumpCtrl: true,
        jumpControl: Mobi.jumpControl
    };
    $.extend(a, b);
    var c = new baidu.editor.ui.Editor({
        upLoadFlashUrl: "/ajax/upfile_h.jsp?type=50",
        ueditorChangeEvent: a.setPageChange,
        htmlModuleRichTip: a.jinrfRichTip,
        initialContent: a.initContent,
        imageExtends: a.imageExtends,
        minFrameHeight: a.minFrameHeight,
        wordCount: a.wordCount,
        customDomain: a.customDomain,
        maximumWords: a.maximumWords,
        fixUrl: a.fixUrl,
        swfuploadSrc: a.swfuploadSrc,
        isPasteImage: a.isPasteImage,
        setContentTxt: a.setContentTxt,
        flashHidden: a.flashHidden,
        htmlChoiceImage: a.htmlChoiceImage,
        htmlChoiceMP4: a.htmlChoiceMP4,
        toolbars: a.toolbars,
        fontfamily: a.fontfamily,
        openJumpCtrl: a.openJumpCtrl,
        isMobi: a.isMobi,
        jumpCtrlFunc: a.jumpControl,
        mobiEditor: a.mobiEditor
    });
    c.render(a.ueditorId);
    return c
};
Mobi.jumpControl = function(i) {
    var c = {
        inputId: null,
        moduleType: 1,
        ueditor: false,
        mobiEditor: false,
        jumpType: null,
        jumpIde: null,
        jumpUrl: null,
        jumpName: null,
        setPageChange: null,
        skipMobiColId: null,
        fromMobi: true,
        difSource: false
    };
    if (c.inputId) {
        return
    }
    $.extend(c, i);
    var f, h;
    if (c.ueditor) {
        f = "jumpCtrlUE"
    } else {
        f = "jumpCtrl"
    }
    var e = $("#" + f),
    d = $("#" + c.inputId);
    if (!c.ueditor) {
        d.css("float", "left")
    }
    var b = c.jumpType;
    if (b != 103 && b != 0) {
        d.attr("disabled", true)
    } else {
        d.attr("disabled", false)
    }
    if (c.jumpName != null) {
        d.val(c.jumpName)
    } else {
        d.val("")
    }
    var g = false;
    if (c.fromMobi) {
        if (b == 0 && c.skipMobiColId > 0) {
            d.attr("disabled", true)
        }
        if (b == 100 && c.skipMobiColId === 0) {
            d.attr("disabled", false)
        }
        if (c.mJName != null) {
            d.val(c.mJName)
        }
        if (c.skipMobiColId != null) {
            g = true
        }
    }
    if (e.length === 0) {
        if (c.ueditor) {
            h = ["<td colspan='4'>", "<div id='jumpCtrlUE' class='jumpCtrlUE' ", "_lType='", c.jumpType, "' _lIde='", c.jumpIde, c.mJType ? "' _extType='" + c.mJType: "", c.mJIde ? "' _extJIde='" + c.mJIde: "", c.mJName ? "' _extJName='" + c.mJName: "", "'>设置链接</div>", "</td>"];
            d.parent().after(h.join(""))
        } else {
            h = ["<div id='jumpCtrl' class='jumpCtrl' ", "_lType='", c.jumpType, "' _lIde='", c.jumpIde, g ? "' _skipMobiColId='" + c.skipMobiColId: "", "'>设置链接</div>"];
            d.after(h.join(""))
        }
        e = $("#" + f);
        e.hover(function() {
            $(this).addClass("j_ctrl_hover")
        },
        function() {
            $(this).removeClass("j_ctrl_hover")
        })
    } else {
        e.attr("_lType", c.jumpType);
        e.attr("_lIde", c.jumpIde);
        e.removeAttr("_lname _lurl _extJUrl");
        if (c.ueditor) {
            if (c.mJType == null) {
                e.removeAttr("_extType")
            } else {
                e.attr("_extType", c.mJType)
            }
            if (c.mJIde == null) {
                e.removeAttr("_extJIde")
            } else {
                e.attr("_extJIde", c.mJIde)
            }
            if (c.mJName == null) {
                e.removeAttr("_extJName")
            } else {
                e.attr("_extJName", c.mJName)
            }
        }
    }
    d.unbind("keyup change").bind("keyup change",
    function() {
        e.attr("_lType", 103);
        if (d.val() === "") {
            e.attr("_lIde", "");
            e.attr("_lUrl", "")
        } else {
            e.attr("_lIde", Mobi.fixUrl(d.val(), JRF.top._userHostName));
            e.attr("_lUrl", Mobi.fixUrl(d.val(), JRF.top._userHostName));
            e.removeAttr("_extType _extJUrl _extJIde _extJName")
        }
        if (c.setPageChange != null) {
            c.setPageChange()
        }
    });
    var a = Mobi.getPreviewWindow().Mobi.getSiteMultiLanguageUrl() + "/manage/linkSetting.jsp?ram=" + Math.random() + "&fromMobi=true&m=" + c.moduleType + (c.ueditor ? "&editor=true": "");
    if (c.difSource) {
        a += "&difSource=true"
    }
    if (c.mobiEditor) {
        a += "&mEditor=true"
    }
    e.unbind("click").bind("click",
    function() {
        var j = a + "&lType=" + e.attr("_lType") + "&lIde=" + e.attr("_lIde");
        if (g) {
            j += "&skipMobiColId=" + e.attr("_skipMobiColId")
        }
        var k = e.attr("_extJIde");
        if (k != null) {
            j += "&jExtIde=" + k
        }
        JRF.popupWindow({
            title: "设置链接地址",
            width: 460,
            height: 240,
            frameScrolling: false,
            frameSrcUrl: j,
            closeFunc: function(m) {
                if (m != null) {
                    e.removeAttr("_extType _extJUrl _extJIde _extJName");
                    if (m.type == 103) {
                        d.val(m.url);
                        d.attr("disabled", false);
                        e.attr("_lType", m.type);
                        e.attr("_lIde", m.jIde);
                        if (m.jumpUrl) {
                            e.attr("_lUrl", m.jumpUrl)
                        }
                    } else {
                        var l = m.name;
                        if (m.extName && c.fromMobi) {
                            l = m.extName
                        }
                        d.val(l);
                        d.attr("disabled", true);
                        e.attr("_lType", m.type);
                        e.attr("_lIde", m.jIde);
                        e.attr("_lName", m.name);
                        if (m.jumpUrl) {
                            e.attr("_lUrl", m.jumpUrl)
                        }
                        if (m.skipMobiColId) {
                            e.attr("_skipMobiColId", m.skipMobiColId)
                        }
                        if (m.extType) {
                            e.attr("_extType", m.extType)
                        }
                        if (m.extJUrl) {
                            e.attr("_extJUrl", m.extJUrl)
                        }
                        if (m.extJIde) {
                            e.attr("_extJIde", m.extJIde)
                        }
                        if (m.extName) {
                            e.attr("_extJName", m.extName)
                        }
                    }
                    if (c.setPageChange != null) {
                        c.setPageChange()
                    }
                }
            }
        })
    })
};
Mobi.selectBanner = function() {
    var e = JRF.top.document.getElementById("mobiTemplateFrame").contentWindow.$,
    c = e("#mobiTemplateColumn .mobiTempActive"),
    b = e("#mobiTemplateColumn .mobiTempActive .icon"),
    a = e("#mobiTemplateColumn .mobiTempActive .mobiTempText");
    var d = e("#mobiChoiceBanner");
    if (d.find(".mobiTempCurrent").size() !== 0) {
        return
    }
    if (!e("#mobiBannerFrame").attr("src")) {
        e("#mobiBannerFrame").attr("src", "mobiBanner.jsp")
    }
    b.attr("class", "icon banner");
    a.text(e("#mobiChoiceBanner").text());
    c.css("top", (d[0].offsetTop) + "px");
    e("#mobiTemplatePanel .choicePanel").css("display", "none");
    e("#mobiChoiceBannerPanel").css("display", "block").addClass("fadeInDown")
};
Mobi.createBannerSwipeHandle = function() {
    var b = [],
    p = [],
    c = false,
    g = JRF.top._bannerData.b.length,
    l = Mobi.getPreviewObject("webBanner");
    for (var n in JRF.top._bannerData.b) {
        var m = JRF.top._bannerData.b[n];
        var o = m.i,
        a = m.lt,
        f = m.u,
        q = m.p,
        k = m.t,
        e = parseInt(m.h ? m.h: 150),
        j = parseInt(m.w ? m.w: 480);
        if (a == 2) {
            var i = JRF.top._mobiColUrlList;
            for (var d in i) {
                if (i[d].id == f) {
                    f = i[d].url;
                    break
                }
            }
        }
        b.push("<div id='bannerItem" + o + "'>");
        if (a == 1 || a == 2) {
            b.push("<a href='" + f + "'>")
        }
        b.push("<div vheight='" + e + "' vwidth='" + j + "' class='bannerImageDiv " + (k == 0 ? "systemtBanner": "customBanner") + "' style='background-image:url(" + q + ");'></div>");
        if (a == 1 || a == 2) {
            b.push("</a>")
        }
        b.push("</div>");
        if (g != 1) {
            if (!c) {
                p.push("<li class='on'></li>");
                c = true
            } else {
                p.push("<li></li>")
            }
        }
    }
    var h = "<div id='bannerSwipe' class='swipe'><div class='bannerSwipeContainer defaultBanner'>" + b.join("") + "</div>" + (JRF.top._bannerData.b.length > 1 ? "<div id='bannerBullet' class='bannerBullet'><ul id='bullets' class='bullets'>" + p.join("") + "</ul></div>": "") + "</div>";
    if (b.length === 0) {
        $(Mobi.getPreviewObject("webBanner")).removeClass("hiddenDefaultBanner")
    } else {
        if (!$(Mobi.getPreviewObject("webBanner")).hasClass("hiddenDefaultBanner")) {
            $(Mobi.getPreviewObject("webBanner")).addClass("hiddenDefaultBanner")
        }
    }
    $(l).html("").append(h);
    Mobi.getPreviewWindow().Mobi.initSwipe("bannerSwipe");
    Mobi.AllShowTopForBottom();
    Mobi.styleChanged()
};
Mobi.styleChanged = function(a) {
    JRF.top._changeStyleNum++;
    JRF.top.$("#saveButton").removeClass("buttonDisabled");
    JRF.top.$("#cancelButton").removeClass("buttonDisabled");
    JRF.top.$("#viewButton").addClass("buttonDisabled");
    if (!a) {
        if ($(Mobi.getPreviewObject("mobiImagePage")).length > 0) {
            $(Mobi.getPreviewObject("mobiImagePage")).remove();
            $(Mobi.getPreviewObject("g_web")).show();
            Mobi.changeNavigatorUrl(Mobi.getPreviewDocument().URL)
        }
    }
};
Mobi.styleRecover = function() {
    JRF.top._changeStyleNum = 0;
    JRF.top.$("#saveButton").addClass("buttonDisabled");
    JRF.top.$("#cancelButton").addClass("buttonDisabled");
    JRF.top.$("#viewButton").removeClass("buttonDisabled")
};
Mobi.replaceDocumentwriteText = function(b) {
    var a = b.replace(/(.*?<script[\s\S]*?)document\.write([\s\S]*?<\/script>.*?)/gi, "$1void$2");
    return a
};
Mobi.popupWindow = function(a) {
    var b = true;
    if (!JRF.isNull(a.saveBeforePopup)) {
        b = a.saveBeforePopup
    }
    if (b && Mobi.checkSaveBar()) {
        return
    }
    if ($.isFunction(Mobi.getPreviewWindow().Mobi.removeAllEditLayer)) {
        Mobi.getPreviewWindow().Mobi.removeAllEditLayer()
    }
    JRF.popupWindow(a)
};
Mobi.fixUrl = function(a, b) {
    if (!a || !b) {
        return
    }
    b = JRF.fixUrl(b);
    a = JRF.fixUrl(a);
    a = a.indexOf(JRF.top._visitorHostName) > -1 ? a.replace(JRF.top._visitorHostName, "") : a;
    subStrUrl = a.substring(0, b.length);
    if (subStrUrl === b) {
        return subStrUrl == a ? "/": a.substring(b.length, a.length)
    } else {
        return a
    }
};
Mobi.htmlChoiceImage = function(a) {
    var b = {
        title: "添加图片",
        maxSize: 10,
        type: ["jpg", "jpeg", "bmp", "png", "gif"],
        imgMode: 2,
        maxChoiceList: 10,
        netFileMode: true
    };
    Mobi._htmlTmpData = a;
    Mobi.fileUpload2("", b, Mobi.htmlUploadBack)
};
Mobi.htmlChoiceMP4 = function(a) {
    var b = {
        title: "添加MP4",
        maxSize: parseInt(JRF.top.file_size_limit) || 5,
        type: ["mp4"],
        imgMode: 2,
        maxChoiceList: 1,
        netFileMode: true
    };
    Mobi._htmlTmpData = a;
    Mobi.fileUpload2("", b, Mobi.htmlUploadBackMp4)
};
Mobi.htmlUploadBackMp4 = function(a) {
    var c = "";
    if (a) {
        var b = $.parseJSON(a);
        b = b.data;
        if (b.length) {
            c = '<p style="text-align:center;line-height:0px"><br /></p><p style="text-align:center;line-height:0px;"><video style="width:400px;BACKGROUND:#000;height:400px" controls="controls"><source src="' + b[0].filePath + '" type="video/mp4" /><embed width="400" height="400" type="application/x-shockwave-flash" src="' + JRF.top._resSiteRoot + "/js/comm/jwplayer/jwplayer.swf?file=" + b[0].filePath + '" allowfullscreen="true" /></video><br /></p>'
        } else {
            c = ""
        }
    }
    if (Mobi._htmlTmpData) {
        Mobi._htmlTmpData.pasteChoiceMp4(c)
    }
};
Mobi.htmlUploadBack = function(b) {
    var f = "";
    if (b) {
        var e = $.parseJSON(b);
        e = e.data;
        if (e.length) {
            for (var c = 0; c < e.length; c++) {
                var d = e[c].fileWidth;
                var a = e[c].fileHeight;
                f += '<img src="' + e[c].filePath + '" data-source="' + e[c].pre640ViewPath + '"';
                if (d && a) {}
                f += "/>"
            }
        } else {
            f = ""
        }
    }
    if (Mobi._htmlTmpData) {
        Mobi._htmlTmpData.pasteChoiceImage(f)
    }
};
Mobi.checkSaveBar = function(b, a) {
    if (JRF.top._changeStyleNum > 0) {
        Mobi.popupStyleChangeBodyWindow("您的网站设计已经更改，是否立即保存？", b, a);
        return true
    }
    return false
};

Mobi.radioLableSelect = function (obj,level){
	if(!level){
		level = 2;
		}
	var parentDiv  = $(obj);
	for(var i =0;i<level;i++){
			parentDiv = parentDiv.parent();
			}	
	$(parentDiv).find(".m_radio").removeClass("m_radiochecked");
	$(obj).addClass("m_radiochecked");
	};
Mobi.popupStyleChangeBodyWindow = function(g, h, e, a, d) {
    var c = "确定";
    var f = "取消";
    if (typeof a != "undefined") {
        c = "" + a
    }
    if (typeof d != "undefined") {
        f = "" + d
    }
    var b = top.JRF.popupBodyWindow({
        title: "操作提示",
        content: "<div class='operate_tip'><p class='popwinTitle'>" + g + "</p><p class='save_label'><input type='radio' name='save' id='popupWindowSaveChangeBtn' checked='checked' style='vertical-align:-2px;_vertical-align:-1px;' /><label class='m_radio m_radiochecked' for='popupWindowSaveChangeBtn'  onclick='Mobi.radioLableSelect(this)'>立即保存</label></p><p class='save_label'><input type='radio' name='save' id='popupWindowCancelChangeBtn' style='vertical-align:-2px;_vertical-align:-1px;' /><label class='m_radio' for='popupWindowCancelChangeBtn' onclick='Mobi.radioLableSelect(this)' style='cursor:pointer;'>不保存</label></p></div>",
        width: 350,
        height: 120
    });
	
	
    top.JRF.addPopupBodyWindowBtn(b, {
        id: "save",
        text: c,
        extClass: "saveButton",
        click: function() {
            if (top.$(top.document).find("#popupWindowSaveChangeBtn").length > 0 && top.$(top.document).find("#popupWindowSaveChangeBtn").prop("checked")) {
                Mobi.saveStyle(h)
            } else {
                if (typeof h != "undefined" && typeof h.fun === "function" && !h.funRun && typeof e != "undefined" && e && !top.$(top.document).find("#popupWindowCancelChangeBtn").prop("checked")) {
                    setTimeout(function() {
                        h.fun.apply(window, h.args)
                    },
                    10)
                } else {
                    JRF.top.location.reload()
                }
            }
            JRF.top.JRF.closePopupBodyWindow(b)
        }
    });
    top.JRF.addPopupBodyWindowBtn(b, {
        id: "cancel",
        text: f,
        click: "close"
    })
};
Mobi.initDrag = function() {
    var a = $(Mobi.getModuleWindow().document).find(".mainIcon");
    if (a.get().length) {
        b()
    } else {
        $("#mobiModuleFrame").on("load",
        function() {
            b()
        })
    }
    function b() {
        if (JRF.isIE()) {
            a = $(Mobi.getModuleWindow().document).find(".mainIcon")
        } else {
            a = $(Mobi.getModuleWindow().document).find("#mobiNewModulePanel .addNewModule");
            a.attr("draggable", "true")
        }
        var i = $(Mobi.getPreviewDocument()).find("#webModuleContainer"),
        c = i.parents("body"),
        f = new Array(),
        e = false,
        j,
        h = new Array(),
        g = false;
        a.off("dragstart", "").on("dragstart",
        function(o) {
            preModulePosition = 0;
            g = true;
            d();
            j = o.target;
            var q = $(Mobi.getPreviewDocument()).find("#webCustomerServiceBox");
            if (q.is(":not(:hidden)")) {
                q.hide();
                $(this).one("dragend",
                function() {
                    q.show()
                })
            }
            if ($("#mobiModule").attr("_mousein") == 1) {
                var l = $("#mobiModule");
                l.attr("_mousein", 0);
                l.removeClass("mobiModuleShow");
                $("#modulePanelBg").removeClass("modulePanelShowBg")
            }
            var m = o.originalEvent.dataTransfer;
            if (m.setDragImage) {
                var n = $(this);
                var p = n.children(".mainIcon").clone().appendTo(n.parent()).css({
                    position: "absolute",
                    "z-index": "-1",
                    top: "35%",
                    left: "35%"
                });
                var k = $(this).parent().css("background-color", "#fff");
                m.setDragImage(p.get(0), 35, 31);
                setTimeout(function() {
                    p.remove();
                    k.css("background-color", "transparent")
                },
                0)
            }
            m.setData("text", " ")
        });
        c.on("dragover",
        function(p) {
            if (!g) {
                return false
            }
            p.preventDefault();
            var m = p.originalEvent.pageY,
            q, o;
            if (!e) {
                $("<div id='dragPlaceholder' style='width:98%; height:80px; margin:10px auto; border:dashed 1px #3297ff; background-color:#cbe3fb; color:#3297ff; font-size:13px; line-height:80px; text-align:center;'>放到这里</div>").prependTo(i);
                e = true
            }
            if (i.children(".addNewModule").get(0) || m <= f[0]) {
                q = 0
            } else {
                if (m > f[f.length - 1]) {
                    q = f.length
                } else {
                    for (var n = 0,
                    k = f.length - 1; n < k; n++) {
                        if (m > f[n] && m <= f[n + 1]) {
                            q = n + 1;
                            break
                        }
                    }
                }
            }
            if (q != preModulePosition) {
                preModulePosition = q;
                o = i.children("#dragPlaceholder");
                if (q == 0) {
                    o.prependTo(i)
                } else {
                    o.insertAfter(i.children("div:not('#dragPlaceholder')").eq(q - 1))
                }
                d()
            }
        });
        $(".centerPanel").on("dragenter",
        function(k) {
            if (k.target == $("#navigatorUrl").get(0) || k.target == $(".mobiReviewBackground").get(0) || k.target == $(".centerPanel").get(0)) {
                if (e) {
                    e = false;
                    preModulePosition = 0;
                    i.find("#dragPlaceholder").remove()
                }
            }
        });
        c.on("dragover",
        function(p) {
            p = p.originalEvent;
            var o = $(this),
            n = o.height(),
            m = 15,
            k = 50,
            l = p.clientY,
            q = $(Mobi.getPreviewDocument());
            if (l <= k) {
                q.scrollTop(q.scrollTop() - m)
            } else {
                if (l >= n - k) {
                    q.scrollTop(q.scrollTop() + m)
                }
            }
        });
        a.off("dragend", "").on("dragend",
        function() {
            g = false;
            e = false;
            i.children("#dragPlaceholder").remove()
        });
        c.on("drop",
        function(k) {
            if (!g) {
                return false
            }
            j.click();
            return false
        });
        function d() {
            f = [];
            i.children("div:not('#dragPlaceholder')").each(function() {
                var l = $(this);
                var k = Math.floor(l.offset().top + l.height() / 2);
                f.push(k)
            })
        }
    }
};
Mobi.addCtrlStyle = function(a, d) {
    var c = $("#" + a);
    var e = new Array();
    if (c.length == 1) {
        var b = c.html();
        b = b.replace(/{\r\n/g, "{").replace(/\t/g, "").replace(/\r\n}/g, ";}");
        e = b.split("\n");
        c.remove()
    }
    e.push(d);
    $(Mobi.getPreviewDocument().querySelector("head")).append('<style type="text/css" id="' + a + '">' + e.join("\n") + "</style>")
};
Mobi.changeBackgroundImage = function(a) {
    //if (top.window._colId !== 3) {
    //    JRF.ing("选择背景只允许在首页显示", true);
    //    return
    //}
    if ($(Mobi.getPreviewObject("mobiImagePage")).length > 0) {
        $(Mobi.getPreviewObject("mobiImagePage")).remove();
        $(Mobi.getPreviewObject("g_web")).show();
        Mobi.changeNavigatorUrl(Mobi.getPreviewDocument().URL)
    }
    var d = Mobi.getPreviewObject("webBodyBackground"),
    c = Mobi.getPreviewObject("g_web"),
    b = Mobi.getPreviewObject("webContainerBox");
    if (JRF.top.backgroundImageJson.sysnum === 0) {
        $(d).css("background", "");
        $(c).css("background", "");
        $(b).css("background", "");
        $(Mobi.getPreviewObject("webBodyBackgroundStyle")).remove();
        $(d).removeClass("webBackgroundFix")
    }
    if ((JRF.top.backgroundImageJson.type === 0 && JRF.top.backgroundImageJson.sysnum !== 0) || JRF.top.backgroundImageJson.type === 1) {
        $(d).addClass("webBackgroundFix");
        if(JRF.top.backgroundImageJson.type != 1){
        	a = a.substring(1,a.length - 1);
        }
        $(d).css({"background":'url('+ a +') center center',"background-size":"cover"});
        $(c).css("background", "none");
        $(b).css("background", "none")
    } else {
        if (JRF.top.backgroundImageJson.type === 2) {
            $(d).addClass("webBackgroundFix");
            $(d).css("background", JRF.top.backgroundImageJson.b_color);
            $(b).css("background", "none");
            $(c).css("background", "none")
        }
    }
};
/** 改变手机欢迎页背景*/
Mobi.changeImagePageFun = function(e, c, m) {
    if ($(Mobi.getPreviewObject("mobiImagePage")).length > 0) {
        $(Mobi.getPreviewObject("mobiImagePage")).remove();
        $(Mobi.getPreviewObject("g_web")).show()
    }
    if (!JRF.top._imagePageJson.open) {
        return
    }
    var h, g, b;
    //系统默认背景模式
    if (JRF.top._imagePageJson.type == 0) {
        if (JRF.top._imagePageJson.sysnum === 0) {
            var l = 0;
            for (var a in JRF.top._templateDefList) {
                if (JRF.top._templateFrameId === JRF.top._templateDefList[a].id) {
                    l = JRF.top._templateDefList[a].imagePage;
                    break
                }
            }
            for (var k in JRF.top._imagePageDefList) {
                if (l === JRF.top._imagePageDefList[k].id) {
                    e = JRF.top._imagePageDefList[k];
                    break
                }
            }
        } else {
            for (var k in JRF.top._imagePageDefList) {
                if (JRF.top._imagePageJson.sysnum === JRF.top._imagePageDefList[k].id) {
                    e = JRF.top._imagePageDefList[k];
                    break
                }
            }
        }
    }
    JRF.top._viewImagePageInfo = e;
    if (top.window._colId !== 0 || (JRF.top._imagePageJson.sysnum !== 0 && !c) || JRF.top._insideImagePage || !e) {
        return
    }
    h = e.id,
    g = e.view,
    b = '<div id="mobiImagePage" class="mobiImagePage">'+
	    		'<div id="imagePageLoading" class="loading">'+
	    			'<div id="splashscreen" class="splashscreen ui-loader">'+
	    				'<span class="ui-icon ui-icon-loading spin"></span>'+
	    				'</div>'+
	    		'</div>'+
	    		'<div class="backgroundPageImage" id="backgroundPageImage"></div>'+
	    		'<img style="display:none" id="tempImage">'+
	    		'<div id="insideFirstPage" class="insideFirstPage">'+
	    			'<div class="imagePageButton imagePageButton' + h + '">'+
	    				'<span class="button button' + h + '" href="javascript:void(0);"></span>'+
	    			'</div>'+
    			'</div>'+
    		'</div>';
    $(Mobi.getPreviewObject("g_body")).prepend(b);
    var j = Mobi.getPreviewObject("backgroundPageImage"),
    i = Mobi.getPreviewObject("tempImage"),
    d = Mobi.getPreviewObject("imagePageLoading"),
    f = Mobi.getPreviewObject("insideFirstPage");
    i.onload = function() {
        j.style.background = "url('" + g + "') white";
        j.style.backgroundPosition = "50% 50%";
        j.style.webkitBackgroundPosition = "50% 50%";
        j.style.mozBackgroundPosition = "50% 50%";
        j.style.oBackgroundPosition = "50% 50%";
        j.style.backgroundRepeat = "no-repeat";
        j.style.webkitBackgroundRepeat = "no-repeat";
        j.style.mozBackgroundRepeat = "no-repeat";
        j.style.oBackgroundRepeat = "no-repeat";
        var r = i.width || i.naturalWidth || 0,
        n = i.height || i.naturalHeight || 0,
        p = f.clientHeight,
        q = f.clientWidth;
        if (r != q) {
            var o = Math.round((n * q) / r);
            j.style.height = (o > p ? o: p) + "px";
            j.style.backgroundSize = q + "px " + o + "px"
        }
        d.parentNode.removeChild(d);
        if (m && m.isTemplate) {
            Mobi.getPreviewWindow().Mobi.logoSizeCompressByMargin();
            Mobi.getPreviewWindow().Mobi.titlePositionRefreshByLogo()
        }
        $(Mobi.getPreviewObject("g_web")).hide()
    };
    i.src = g;
    Mobi.changeNavigatorUrl(Mobi.getPreviewDocument().URL);
    if (JRF.isIE()) {
        $(Mobi.getPreviewObject("backgroundPageImage")).bind("click",
        function() {
            $(Mobi.getPreviewObject("mobiImagePage")).remove();
            $(Mobi.getPreviewObject("g_web")).show();
            Mobi.changeNavigatorUrl(Mobi.getPreviewDocument().URL);
            JRF.top._insideImagePage = true;
            return false
        })
    }
    $(Mobi.getPreviewObject("insideFirstPage")).bind("click",
    function() {
        $(Mobi.getPreviewObject("mobiImagePage")).remove();
        $(Mobi.getPreviewObject("g_web")).show();
        Mobi.changeNavigatorUrl(Mobi.getPreviewDocument().URL);
        JRF.top._insideImagePage = true;
        return false
    })
};
Mobi.removeDefaultCubeList = function(e, d) {
    var a = d;
    var b = {
        isRemove: false,
        other: a
    };
    var c = 0;
    if (a.cml) {
        c = a.cml.indexOf(parseInt(e))
    }
    if (c != -1) {
        a.cml.splice(c, 1);
        b.other = a;
        b.isRemove = true
    }
    JRF.top._other.cml = a.cml;
    JRF.top._otherChange = 1;
    return b
};
Mobi.createCubeWithDefault = function(c, a, b) {
    var k = [];
    var g = [];
    var f = 0;
    for (var e in a) {
        if (c == a[e].id) {
            f = a[e].hasSubTitle;
            k = a[e].initLink;
            break
        }
    }
    for (var d in k) {
        var h = {};
        $.extend(h, b);
        h.text = k[d].text;
        if (f == 1) {
            h.subText = k[d].subText
        }
        g.push(h)
    }
    return g
};
Mobi.initCubeNavigation = function(k, h, a, c, b, g) {
    var h = h;
    var a = a;
    var e = "../ajax/mobimodule_h.jsp?cmd=add&colId=3&style=" + b;
    var j = [];
    h.cubeLayoutId = k;
    for (var f in a) {
        if (k == a[f].id) {
            h.cubeType = parseInt(a[f].type);
            break
        }
    }
    j = Mobi.createCubeWithDefault(k, a, c);
    h.linkList = j;
    var d = [];
    d.push("style=" + b);
    d.push("&name=" + JRF.encodeUrl(""));
    d.push("&content=" + JRF.encodeUrl($.toJSON(h)));
    $.ajax({
        type: "post",
        url: e,
        data: d.join(""),
        error: function() {
            JRF.ing("服务繁忙，请稍后再试。", false)
        },
        success: function(l) {
            var i = jQuery.parseJSON(l);
            if (JRF.successHandle(l, "", "系统错误", "", 3, 1)) {
                Mobi.addNewModule(i.id, i.div, i.moduleInfo);
                Mobi.changeModuleStyle("module" + i.id, h.cubeLayoutId, JRF.top._templateFrameId);
                Mobi.setCusModCount();
                g(k)
            }
        }
    })
};
Mobi.changeCubeStyle = function(u, b, x) {
    var f = 1;
    var d = [];
    for (var q in b) {
        if (!b[q].linkHide) {
            var o = b[q].icoType;
            var z = b[q].icoCusType;
            var t = b[q].icoSysContent;
            var s = b[q].icoSysColor;
            var w = b[q].icoSysType;
            var p = b[q].icoSysId;
            var a = b[q].coverType;
            var A = b[q].textData.textType;
            var y = b[q].subTextData.textType;
            var c = b[q].textLayout.layoutType;
            var j = new Object();
            j.id = "#cubeNavigation" + u + "_cubeLink" + f;
            j.bg = "";
            j.picIco = "";
            j.p = "";
            var e = "";
            var g = "";
            if (o == 2) {
                if (!w) {
                    w = 0
                }
                if (z === 0 && w == 0 && t != undefined) {
                    if (t != "") {
                        if (s) {
                            g = "content:'" + t + "';color:" + s
                        } else {
                            g = "content:'" + t + "';"
                        }
                    } else {
                        if (t === "" && s) {
                            g = "color:" + s + ";"
                        }
                    }
                } else {
                    if (z === 1 || (z == 0 && p != 0)) {
                        e = "background-image:url(" + x[q].linkIcoPreViewPath + ");background-color:transparent;background-repeat: no-repeat;background-position: center;"
                    }
                }
            } else {
                if (o == 1) {
                    e = "background-image:none;background-color:transparent;"
                }
            }
            var l = "";
            var m = "";
            var v = "background-image:none;";
            if (a == 2) {
                var k = b[q].cover.tile;
                if (k != -1) {
                    if (x[q].linkCoverPreViewPath != "") {
                        v = "background-image:url(" + x[q].linkCoverPreViewPath + ");";
                        if (k != 101 && k != 102 && k != 103) {
                            k = 101
                        }
                        if (k == 101) {
                            m = "background-size:cover;background-position:center;background-repeat:no-repeat;"
                        } else {
                            if (k == 102) {
                                m = "background-size:100% 100%;background-repeat:no-repeat;"
                            } else {
                                if (k == 103) {
                                    m = "background-size: inherit;background-repeat:repeat;"
                                }
                            }
                        }
                    }
                }
                l += v;
                l += "background-color:" + b[q].cover.color + ";";
                l += m;
                l += "filter:(opacity='" + b[q].cover.opacity + "');opacity:" + (b[q].cover.opacity / 100) + ";"
            } else {
                if (a == 1) {
                    l = "background:transparent;"
                }
            }
            var n = "";
            if (A == 1) {
                n += "color:" + b[q].textData.color + ";";
                n += "font-weight:" + (b[q].textData.bold ? "bold": "normal") + ";";
                n += "font-size:" + b[q].textData.size / 20 + "rem;"
            }
            var h = "";
            if (y == 1) {
                h += "color:" + b[q].subTextData.color + ";";
                h += "font-weight:" + (b[q].subTextData.bold ? "bold": "normal") + ";";
                h += "font-size:" + b[q].subTextData.size / 20 + "rem;"
            }
            j.bg = l;
            j.picIco = e;
            j.fontsIco = g;
            j.p = n;
            j.sp = h;
            d.push(j);
            f++
        }
    }
    Mobi.createCubeStyleCss(d)
};
Mobi.createCubeStyleCss = function(h) {
    var a = $(Mobi.getPreviewObject("mobiCubeStyleModule"));
    var g = new Array();
    if (a.length == 1) {
        var f = a.html();
        f = f.replace(/{\r\n/g, "{").replace(/\t/g, "").replace(/\r\n}/g, ";}");
        g = f.split("\n");
        a.remove()
    }
    for (var e = g.length - 1; e >= 0; e--) {
        var j = g[e];
        for (var d = h.length - 1; d >= 0; d--) {
            var b = h[d].id;
            var c = new RegExp(b.replace(".", "\\."), "gi");
            if (j.length == 0 || /^\s$/.test(j) || c.test(j)) {
                g.splice(e, 1);
                break
            }
        }
    }
    for (var d = 0; d < h.length; ++d) {
        if (h[d].bg != "") {
            g.push(h[d].id + " .cubeLink_bg{" + h[d].bg + "}")
        }
        if (h[d].fontsIco != "") {
            g.push(h[d].id + " .cubeLink_ico{background:none}");
            g.push(h[d].id + " .icon-cube:before{" + h[d].fontsIco + "}")
        } else {
            if (h[d].picIco != "") {
                g.push(h[d].id + " .cubeLink_ico{" + h[d].picIco + "}");
                g.push(h[d].id + " .icon-cube:before{content:none;}")
            }
        }
        if (h[d].p != "") {
            g.push(h[d].id + " .cubeLink_text_p{" + h[d].p + "}")
        }
        if (h[d].sp != "") {
            g.push(h[d].id + " .cubeLink_subText_p{" + h[d].sp + "}")
        }
    }
    $(Mobi.getPreviewDocument().querySelector("head")).append('<style type="text/css" id="mobiCubeStyleModule">' + g.join("\n") + "</style>")
};
Mobi.changeModuleStyle = function(b, d, a) {
    var b = Mobi.getPreviewWindow().$("#" + b);
    var moduleClass = b.attr("class");
    if(!JRF.isNull(moduleClass)){
    	var c = moduleClass.replace(/moduleStyle\d+/, "moduleStyle" + d);
        c = c.replace(/template\d+/, "template" + a);
        b.attr("class", c)
    }
};
Mobi.loadFile = function() {
    var a = [];
    function b(h, g) {
        try {
            for (var d = 0,
            c; c = a[d++];) {
                if (c.doc === h && c.url == (g.src || g.href)) {
                    return c
                }
            }
        } catch(f) {
            return null
        }
    }
    return function(i, h, e) {
        var f = b(i, h);
        if (f) {
            if (f.ready) {
                e && e(f)
            } else {
                f.funs.push(e)
            }
            return
        }
        a.push({
            doc: i,
            url: h.src || h.href,
            funs: [e]
        });
        if (!i.body) {
            var d = [];
            for (var g in h) {
                if (g == "tag") {
                    continue
                }
                d.push(g + '="' + h[g] + '"')
            }
            i.write("<" + h.tag + " " + d.join(" ") + " ></" + h.tag + ">");
            return
        }
        if (h.id && h.realTime) {
            var j = i.getElementById(h.id);
            if (j && j.parentNode) {
                j.parentNode.removeChild(j)
            }
        }
        if (h.id && i.getElementById(h.id)) {
            return
        }
        var c = i.createElement(h.tag);
        delete h.tag;
        for (var g in h) {
            c.setAttribute(g, h[g])
        }
        c.onload = c.onreadystatechange = function() {
            if (!this.readyState || /loaded|complete/.test(this.readyState)) {
                f = b(i, h);
                if (f.funs.length > 0) {
                    f.ready = 1;
                    for (var k; k = f.funs.pop();) {
                        k(f)
                    }
                }
                c.onload = c.onreadystatechange = null
            }
        };
        c.onerror = function() {
            throw Error("加载文件 " + (h.href || h.src) + " 失败 ")
        };
        i.getElementsByTagName("head")[0].appendChild(c)
    }
} ();
Mobi.initTemplateCallback = function() {
    var c = Mobi.getPreviewDocument(),
    a = c.querySelectorAll("#webModuleContainer .productSwipe");
    for (var b = 0; b < a.length; b++) {
        if (a[b].id) {
            Mobi.getPreviewWindow().Mobi.initProductSwipe1(a[b].id)
        }
    }
};
Mobi.setCusModCount = function() {
    JRF.top._cusModuleCount++
};
Mobi.checkSaveBeforePopupWindow = function(a) {
    var b = {};
    b.funRun = true;
    b.fun = Mobi.styleRecover;
    b.args = new Array();
    if (Mobi.checkSaveBar(b, true)) {
        return false
    }
    a && Mobi.popupWindow(a)
};
Mobi.beforeUnloadEvent = function() {
    try {
        Mobi.getPreviewWindow().$("#g_body").delegate('a[href]:not([href*="mailto\\:"],[href*="sms\\:"], [href="\\#"], [href*="tel\\:"],[href*="javascript\\:\\;"])', "click",
        function(c) {
            var b = function(g) {
                if ($(g).parent().hasClass("navItem")) {
                    var f = JRF.top.$("#mobiColumnFrame");
                    if (!f.attr("src") || f.attr("src").indexOf("javascript") != -1) {
                        return
                    } else {
                        var e = $(g).attr("_colid");
                        $(Mobi.getColumnObject("columnTbody")).find(".columnChecked").eq(0).removeClass("columnChecked");
                        $(Mobi.getColumnObject("col" + e)).addClass("columnChecked")
                    }
                }
            };
            var d = {};
            d.fun = Mobi.saveDesignToCheckUpRedirectUrl;
            d.args = new Array();
            d.args.push($(this).attr("href"));
            d.args.push(this);
            d.args.push(b);
            if (Mobi.checkSaveBar(d, true)) {
                return false
            } else {
                b(this)
            }
        });
        Mobi.getPreviewWindow().$("#g_body").on("mousedown", "select,#multiLanguageCtrl",
        function(b) {
            if (JRF.top._changeStyleNum > 0) {
                $(this).blur()
            }
            if (Mobi.checkSaveBar()) {
                return false
            }
        })
    } catch(a) {}
};
/** 上次的请求连接缓存到cookie中*/
Mobi.currentMobiPage = function() {
    var a = JRF.top.$.cookie("_mobiSafeMode") ? JRF.top.$.cookie("_mobiSafeMode") : false;
    var b = JRF.top.$.cookie("_mobiReviewURL") ? JRF.top.$.cookie("_mobiReviewURL") : "../index.jsp";
    b = Mobi.replaceQueryArg(b, "_safeMode", a);
    if(b.indexOf('previewPhone=true') > -1){
    	b = b.replace('previewPhone=true','previewPhone=false');
    }
    $("#mobiReviewPageFrame").attr("src", b)
};
Mobi.fixDomainForIEBug = function() {
    var c = JRF.top.document.querySelectorAll("iframe"),
    a = 'javascript:(function(){document.open();document.domain="' + JRF.top.document.domain + '";document.close();})()';
    for (var b = 0; b < c.length; b++) {
        if (!c[b].src) {
            c[b].src = a
        }
    }
};
/** 初始化缓存*/
Mobi.initPage = function() {
    Mobi.fixDomainForIEBug();
    var a = true;
    $("#mobiReviewPageFrame").load(function() {
        try {
            Mobi.getPreviewDocument();
            if (Mobi.getPreviewDocument().URL === "about:blank" || !$(Mobi.getPreviewDocument().body).attr("jinrfMobi")) {
                JRF.top.$.cookie("_mobiReviewURL", "../index.jsp");
                return
            }
        } catch(c) {
            JRF.top.$.cookie("_mobiReviewURL", "../index.jsp");
            return
        }
        var b = Mobi.changeNavigatorUrl(Mobi.getPreviewDocument().URL);
        var requestUrl = b;
        //请求参数
        var theRequest = new Object();
        var l = b.indexOf("?");
        if (l != -1) {
        	requestUrl = b.substring(0,l);
        	var str = b.substring(l+1);
        	var strs = str.split("&");
        	for(var i = 0; i < strs.length; i ++) {
        		theRequest[strs[i].split("=")[0]] = strs[i].split("=")[1];
        	}
        }
        requestUrl +="?rn="+Math.random();
        for(p in theRequest){
        	if(p=="key"){
        		requestUrl += "&"+p+"="+decodeURI(decodeURI(theRequest[p]));
        	}else if(p=="rn"){
        		
        	}else{
        		requestUrl += "&"+p+"="+theRequest[p];
        	}
        }
        JRF.top.$.cookie("_mobiReviewURL", requestUrl, requestUrl.length);
        if (JRF.top._isOpenDesign && a) {
            Mobi.initTab()
        }
        Mobi.beforeUnloadEvent();
        Mobi.mobiSettingChange();
        Mobi.removeShortCutLayerInRefresh();
        a = false;
        Mobi.initDrag()
    });
    Mobi.currentMobiPage()
};
Mobi.mobiSettingChange = function() {
    Mobi.getSettingWindow().mobiPdIndependenceInit && Mobi.getSettingWindow().mobiPdIndependenceInit()
};
Mobi.triggerGobalEvent = function(a, b) {
    top.$(top.document).trigger(a, b)
};
Mobi.bindGobalEvent = function(a, b) {
    top.$(top.document).on(a, b)
};
/*		Mobi.hideHeader = function(c, a) {
		    var b = Mobi.getPreviewObject("webHeader");
		    if (c === 0) {
		        $(b).show(100,
		        function() {
		            Mobi.getPreviewWindow().Mobi.logoSizeCompressByMargin();
		            Mobi.getPreviewWindow().Mobi.titlePositionRefreshByLogo()
		        });
		        JRF.top._mobiTitleFlg = false
		    } else {
		        $(b).hide(100);
		        JRF.top._mobiTitleFlg = true;
		        a && $(a).attr("checked", true)
		    }
		    JRF.top._mobiTitleFlgChange++;
		    Mobi.styleChanged();
		    Mobi.logDog(200020, 5)
		};*/

/** 变更手机路径条地址*/
Mobi.changeNavigatorUrl = function(a) {
    var b = JRF.top.$("#navigatorUrlInput");
    if (b.length > 0) {
        a = a.replace("http://" + JRF.top._userHostName, "");
        if (a.indexOf("_safeMode=false&") > -1) {
            a = a.replace("_safeMode=false&", "")
        } else {
            if (a.indexOf("?_safeMode=false") > -1) {
                a = a.replace("?_safeMode=false", "")
            } else {
                if (a.indexOf("&_safeMode=false") > -1) {
                    a = a.replace("&_safeMode=false", "")
                }
            }
        }
        var c = JRF.top._visitorHostName + a;
        if (Mobi.getPreviewObject("mobiImagePage")) {
            c = c.replace("index.jsp", "")
        }
        b.val(c);
        return a
    }
};
Mobi.logMsg = function(c) {
    if (!c) {
        return
    }
    var b = "";
    var a = c.indexOf("&");
    if (a >= 0) {
        b = c.slice(a, c.length - 1)
    }
    $.ajax({
        type: "GET",
        url: "/ajax/log_h.jsp?cmd=log&msg=" + JRF.encodeUrl(c),
        data: b
    })
};
Mobi.logDog = function(b, a) {
    $.ajax({
        type: "get",
        url: "/ajax/log_h.jsp?cmd=dog&dogId=" + JRF.encodeUrl(b) + "&dogSrc=" + JRF.encodeUrl(a)
    })
};
Mobi.initPageVal = "";
Mobi.showTopManageFrame = function(a, c, e) {
    top._manageStatus = true;
    if (Mobi.checkSaveBar()) {
        return false
    }
    var b = false;
    topManageFrame = JRF.top.$("#topManageFrame");
    if (topManageFrame.length > 0) {
        topManageFrame.show()
    } else {
        b = true;
        var f = "<iframe id='topManageFrame' name='topManageFrame' scrolling='auto' frameborder='0' src='' style='width:100%;height:100%;position:fixed;z-index:9031;left:0;top:0;'></iframe>";
        JRF.top.$(f).appendTo("body")
    }
    if (e != "" && e != null) {
        e = "/" + e
    } else {
        e = ""
    }
    if (!JRF.isNull(a) && a != "" && a != "default" && Mobi.initPageVal != a) {
        Mobi.initPageVal = a;
        b = true;
        JRF.top.$("#topManageFrame").attr("src", c + e + "/manageFrame.jsp?_item=" + a + "&_isMobi=true")
    } else {
        if (topManageFrame.length != 1) {
            JRF.top.$("#topManageFrame").attr("src", c + e + "/manageFrame.jsp?_isMobi=true")
        }
    }
    if (b) {
        JRF.top.$("<div class='topForWaiting ajaxLoading2' style='position:fixed;background-color:#fff;height:100%;width:100%;top:0px;z-index:9032'></div>").appendTo("body");
        var d = JRF.top;
        JRF.top.$("#topManageFrame").load(function() {
            d.$(".topForWaiting").remove()
        })
    }
    Mobi.logDog(200025, 2)
};
Mobi.loadPageChange = function(a) {
    $("#cancel").jrfButton("enable");
    Mobi.unSave = false;
    if (typeof a.btnID == "undefined") {
        a.btnID = "save"
    }
    if (typeof a != "undefined") {
        Mobi.setPageChange(false, a.popupID, a.btnID)
    }
    $(window).bind("beforeunload",
    function() {
        if (Mobi.unSave) {
            return "您的修改尚未保存，确定要离开吗？"
        }
    });
    $(":input").each(function(d, c) {
        var f = $(c);
        var b = f.attr("id");
        if (b && typeof a != "undefined" && typeof a.unBindId != "undefined") {
            var e = false;
            $.each(a.unBindId,
            function(g, h) {
                if (b == h) {
                    e = true;
                    return false
                }
            });
            if (e) {
                return true
            }
        }
        if (typeof a != "undefined" && a.unBindClass != "undefined") {
            var e = false;
            $(a.unBindClass).each(function(g, h) {
                if (f.hasClass(h)) {
                    e = true;
                    return false
                }
            });
            if (e) {
                return true
            }
        }
        if (f.attr("type") == "radio" || f.attr("type") == "checkbox") {
            f.bind("click",
            function() {
                Mobi.setPageChange(true, a.popupID, a.btnID)
            })
        } else {
            f.bind("change",
            function() {
                Mobi.setPageChange(true, a.popupID, a.btnID)
            });
            f.bind("keyup",
            function() {
                Mobi.setPageChange(true, a.popupID, a.btnID)
            })
        }
    });
    if (a && a.saveEnable) {
        top.$("#popup" + a.popupID + "save").removeAttr("disabled");
        top.$("#popup" + a.popupID + "save").removeClass("saveButton-disabled")
    }
};
Mobi.setPageChange = function(b, a, c) {
    if (typeof c == "undefined") {
        c = "save"
    }
    Mobi.unSave = b;
    if (typeof a == "undefined") {
        return
    }
    if ($("#" + c).length > 0) {
        if (b) {
            $("#" + c).jrfButton("enable")
        } else {
            $("#" + c).jrfButton("disable")
        }
    } else {
        JRF.setPopupWindowChange(a, b);
        JRF.enablePopupWindowBtn(a, c, b)
    }
};
Mobi.getPageChange = function() {
    return Mobi.unSave
};
Mobi.replaceQueryArg = function(a, j, h) {
    var b = new Array();
    var e = a.indexOf("?");
    if (e != -1) {
        var g = a.substr(e + 1);
        g = g.split("&");
        a = a.substr(0, e);
        for (var d = 0; d < g.length; d++) {
            var f = g[d].split("=")[0];
            var c = unescape(g[d].split("=")[1]);
            if (f == j) {
                c = h
            }
            b.push(f + "=" + c)
        }
    }
    b.push(j + "=" + h);
    return a + "?" + b.join("&")
};
Mobi.removeShortCutLayerInRefresh = function() {
    JRF.top.$(".shortcutLayer").remove()
};
Mobi.afterAddNews = function(a) {
    if (typeof(a) != "undefined") {
        document.location.reload()
    }
};
Mobi.getLocatorFlag = function() {
    var a = JRF.top.location.href,
    b = a.split("/")[3];
    if (b !== "manage") {
        return "/" + b
    }
    return ""
};
Mobi.isShowTopForBottom = function(){
	//判断页面内容是否超出   动态显示top
	var phoneHeight = 0;
	if($(Mobi.getPreviewWindow('mobiReviewPageFrame')).length>0){
		 phoneHeight = $(Mobi.getPreviewWindow('mobiReviewPageFrame')).height();
	}
	var headerHeight = 0;
	if($('#webHeaderBox').is(":visible")){
		headerHeight = $('#webHeaderBox').height();
	}
	var bannerHeight = 155;
	if($('#webBanner').is(":visible")){
		bannerHeight = $('#webBanner').height();
	}
	var containerHeight = 115;
	if($('#webContainerBox').is(":visible")){
		containerHeight = $('#webContainerBox').height();
	}
	if(containerHeight > 0 && containerHeight < 70){
		containerHeight = 75;
	}
	var productSearchHeight = 0;
	if($("#webProductSearchBox").is(":visible")){
		productSearchHeight = $('#webProductSearchBox').height();
	}
	var footerHeight = 0 ;
	if($('#footer').is(":visible")){
		footerHeight = $('#footer').height();	
	}
	var dataHeight = headerHeight + bannerHeight + containerHeight + productSearchHeight + footerHeight;
	if(phoneHeight < dataHeight){
		$('#backTopForBottom').show();
		$('#webFooter').removeAttr('style');
		$("#footer .bottomdiv").css("display","block");
		if(!Mobi.isTopWindow()){
			$(Mobi.getPreviewWindow('mobiReviewPageFrame').document).find("html").attr('style','font-size: 20.125px;');
			$(Mobi.getPreviewWindow('mobiReviewPageFrame').document).find("body").removeAttr('style');
		}
	}else{
		$('#backTopForBottom').hide();
		$('#webFooter').attr('style','bottom: 50px;position: absolute;width: 100%;');
		$("#footer .bottomdiv").css("display","none");
		if(!Mobi.isTopWindow()){
			$(Mobi.getPreviewWindow('mobiReviewPageFrame').document).find("html").css('overflow-y','hidden');
			$(Mobi.getPreviewWindow('mobiReviewPageFrame').document).find("body").css('overflow-y','hidden');
		}
	}
}
Mobi.AllShowTopForBottom = function(){
	//先判断是嵌入页面
	if(Mobi.isTopWindow()){
		Mobi.isShowTopForBottom();
	}else{
		//判断页面内容是否超出   动态显示top
		var phoneHeight = 0;
		if($(Mobi.getPreviewWindow('mobiReviewPageFrame')).length>0){
			 phoneHeight = $(Mobi.getPreviewWindow('mobiReviewPageFrame')).height();
		}
		var obj = top.document.getElementById('mobiReviewPageFrame').contentWindow;
		var headerHeight = 0;
		if($(obj.document.getElementById('webHeaderBox')).is(":visible")){
			headerHeight = $(obj.document.getElementById('webHeaderBox')).height();
		}
		var bannerHeight = 155;
		if($(obj.document.getElementById('webBanner')).is(":visible")){
			bannerHeight = $(obj.document.getElementById('webBanner')).height();
		}
		if(JRF.top._templateLayoutId == 0 || JRF.top._templateLayoutId == 6){
			bannerHeight += 51;
		}
		var containerHeight = 115;
		if($(obj.document.getElementById('webContainerBox')).is(":visible")){
			containerHeight = $(obj.document.getElementById('webContainerBox')).height();
		}
		var productSearchHeight = 0;
		if($(obj.document.getElementById('webProductSearchBox')).is(":visible")){
			productSearchHeight = $(obj.document.getElementById('webProductSearchBox')).height();
		}
		var footerHeight = 0 ;
		if($(obj.document.getElementById('footer')).is(":visible")){
			footerHeight = $(obj.document.getElementById('footer')).height();	
		}
		var dataHeight = headerHeight + bannerHeight + containerHeight + productSearchHeight + footerHeight;
		if(phoneHeight < dataHeight){
			$(obj.document.getElementById('backTopForBottom')).show();
			$(obj.document.getElementById('webFooter')).removeAttr('style');
			$(obj.document.getElementById('footer')).find(".bottomdiv").css("display","block");
			$(Mobi.getPreviewWindow('mobiReviewPageFrame').document).find("html").attr('style','font-size: 20.125px;');
			$(Mobi.getPreviewWindow('mobiReviewPageFrame').document).find("body").removeAttr('style');
		}else{
			$(obj.document.getElementById('backTopForBottom')).hide();
			$(obj.document.getElementById('webFooter')).attr('style','bottom: 50px;position: absolute;width: 100%;');
			$(obj.document.getElementById('footer')).find(".bottomdiv").css("display","none");
			$(Mobi.getPreviewWindow('mobiReviewPageFrame').document).find("html").css('overflow-y','hidden');
			$(Mobi.getPreviewWindow('mobiReviewPageFrame').document).find("body").css('overflow-y','hidden');
		}
	}
}

/**
 * 站点升级体型信息
 * */
Mobi.upgradeReminderFn = function(type){
	/*JRF.popupWindow({
		title:"操作提示",
		frameSrcUrl:"/jrfadmin/jrfcms/module/siteUpgradeReminder.do?type="+type,
		width:450,
		height:200
	});*/

    $.ajax({
        url: "/jrfadmin/jrfcms/module/siteUpgradeReminder.do?type=" + type,
        success: function(data) {
            $("body").append(data);
        }
    });
}

Mobi.radioCheckCss = function(){
	//单选按钮
	$("input[type=radio]:checked").each(function(){
		$("label[for="+$(this).attr("id")+"]").addClass("m_radiochecked");
	})	
	$("input[type=radio]").click(function(){
		var radioName = $(this).attr("name");
		var radioId = $(this).attr("id");
		$("input[name="+radioName+"]").each(function(i , rad){
			if($(rad).attr("id") == radioId){
				$(rad).attr("checked","checked");
				$("label[for="+radioId+"]").addClass("m_radiochecked");
			}else{
				$(rad).removeAttr("checked");
				$("label[for="+$(rad).attr("id")+"]").removeClass("m_radiochecked");
			}
		})
		
	})
	
	//复选
	$("input[type=checkbox]:checked").each(function(){
		$("label[for="+$(this).attr("id")+"]").addClass("m_checked");
	})
	
	$("input[type=checkbox]").click(function(){
		var radioId = $(this).attr("id");
		if($("label[for="+radioId+"]").hasClass("m_checked")){
			$(this).removeAttr("checked");
			$("label[for="+$(this).attr("id")+"]").removeClass("m_checked");
		}else{
			$(this).attr("checked","checked");
			$("label[for="+radioId+"]").addClass("m_checked");
		}
		
	})
}

$(function() {
	/*$(".jrfButton").livequery(function() {
        $(this).jrfButton()
    })*/
	
	Mobi.radioCheckCss();

    // 搜索框弹出层
    var windowHeight = $(window).height();
    $("#jrfSearchWin").css("bottom",-windowHeight);
    
    function jrfSearchWin(){
         $("#jrfSearchWin").animate({
            "bottom":0
        },600);
    }
    //  从搜索返回
    function cancelSearchWin(obj){
        $(obj).parents("#jrfSearchWin").animate({
            "bottom":-windowHeight
        },600);
    }
});
